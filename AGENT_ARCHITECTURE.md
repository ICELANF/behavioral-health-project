# BehaviorOS V4.0 Agent ç³»ç»Ÿæ¶æ„æŒ‡å—

> **C1 æ²»ç†æ–‡æ¡£** â€” Agent å®ç°åˆ†å¸ƒåœ¨ 5 ä¸ªç›®å½•, æ­¤æ–‡æ¡£å®šä¹‰ä¸»ä»å…³ç³»ä¸å¼€å‘è§„èŒƒ

## æ¶æ„æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Agent äº”å±‚æ¶æ„                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ assistant_agents/   â”‚    â”‚ professional_agents/ â”‚         â”‚
â”‚  â”‚ (ç”¨æˆ·å±‚ Agent)       â”‚    â”‚ (æ•™ç»ƒå±‚ Agent)       â”‚  â† åŒå±‚ â”‚
â”‚  â”‚ 3 files             â”‚    â”‚ 3 files             â”‚  æ¶æ„   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚           â”‚                          â”‚                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚         core/agents/ (æ ¸å¿ƒç¼–æ’å±‚)                â”‚  â† ä¸»è¦ â”‚
â”‚  â”‚         13 files                               â”‚  æ´»è·ƒ   â”‚
â”‚  â”‚         specialist_agents + integrative_agents  â”‚         â”‚
â”‚  â”‚         router + policy_gate                   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚           â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ agents/ (æ—§ç‰ˆè¾…åŠ©å±‚)    â”‚  â”‚ behavior_rx/agents/ â”‚         â”‚
â”‚  â”‚ 11 files               â”‚  â”‚ (ä¸“ç—… Agent)        â”‚  â† é¢†åŸŸ â”‚
â”‚  â”‚ octopus_engine + FSM   â”‚  â”‚ 5 files             â”‚  ç‰¹åŒ–   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ç›®å½•èŒè´£å®šä¹‰

| ç›®å½• | è§’è‰² | æ–‡ä»¶æ•° | èŒè´£ | å¯å†™å…¥ |
|------|------|--------|------|--------|
| `core/agents/` | **æ ¸å¿ƒç¼–æ’** | 13 | Agentè·¯ç”±ã€ç¼–æ’ã€ç­–ç•¥é—¨æ§ã€é¢†åŸŸæ˜ å°„ | âœ… ä¸»è¦å¼€å‘åŒº |
| `assistant_agents/` | **ç”¨æˆ·å±‚åŸºç±»** | 3 | é¢å‘ç”¨æˆ·çš„AgentåŸºç±»ä¸é€šç”¨èƒ½åŠ› | âœ… ç”¨æˆ·å±‚æ‰©å±• |
| `professional_agents/` | **æ•™ç»ƒå±‚åŸºç±»** | 3 | é¢å‘æ•™ç»ƒçš„AgentåŸºç±»ä¸ä¸“ä¸šèƒ½åŠ› | âœ… æ•™ç»ƒå±‚æ‰©å±• |
| `behavior_rx/agents/` | **ä¸“ç—…Agent** | 5 | è¡Œä¸ºå¤„æ–¹é¢†åŸŸç‰¹åŒ–Agent(å¿ƒè¡€ç®¡/ä»£è°¢ç­‰) | âœ… é¢†åŸŸæ‰©å±• |
| `agents/` | **æ—§ç‰ˆè¾…åŠ©** âš ï¸ | 11 | octopus_engine/FSMç­‰æ—§ç‰ˆå®ç° | âŒ ä»…ç»´æŠ¤, ä¸æ–°å¢ |

## å¼€å‘è§„èŒƒ

### æ–°å»º Agent åº”æ”¾åœ¨å“ªé‡Œ?

```
ç”¨æˆ·å¯è§çš„é€šç”¨Agent       â†’ assistant_agents/
æ•™ç»ƒä¸“ç”¨çš„ä¸“ä¸šAgent       â†’ professional_agents/
è¡Œä¸ºå¤„æ–¹é¢†åŸŸç‰¹åŒ–Agent     â†’ behavior_rx/agents/
Agentç¼–æ’/è·¯ç”±/é—¨æ§é€»è¾‘   â†’ core/agents/
```

### ç¦æ­¢äº‹é¡¹

1. **âŒ ç¦æ­¢åœ¨ `agents/` ç›®å½•æ–°å»ºæ–‡ä»¶** â€” è¯¥ç›®å½•ä¸ºæ—§ç‰ˆ, ä»…ç»´æŠ¤ä¸æ‰©å±•
2. **âŒ ç¦æ­¢åœ¨ Agent ä¸­ç›´æ¥å®ç°é˜¶æ®µåˆ¤å®š** â€” ä½¿ç”¨ `StageAuthority` (C3)
3. **âŒ ç¦æ­¢åœ¨ Agent ä¸­ç›´æ¥å†™å…¥ User ç¼“å­˜å­—æ®µ** â€” ä½¿ç”¨ `FieldSyncGuard` (C4)
4. **âŒ ç¦æ­¢è·¨å±‚ç›´æ¥è°ƒç”¨** â€” ç”¨æˆ·å±‚Agentä¸ç›´æ¥è°ƒç”¨æ•™ç»ƒå±‚Agent

### è°ƒç”¨é“¾è§„èŒƒ

```python
# âœ… æ­£ç¡®: é€šè¿‡ router åˆ†å‘
from core.agents.router import AgentRouter
agent = await AgentRouter.resolve(domain, user_role)

# âŒ é”™è¯¯: ç›´æ¥å®ä¾‹åŒ–
from agents.octopus_engine import OctopusAgent  # æ—§ç‰ˆ, ä¸è¦ç›´æ¥ç”¨
```

## è¿ç§»è®¡åˆ’

| é˜¶æ®µ | å†…å®¹ | çŠ¶æ€ |
|------|------|------|
| Phase 1 | ä¸»ä»å…³ç³»æ ‡è®° + README | âœ… æœ¬æ¬¡å®Œæˆ |
| Phase 2 | `agents/` æ—§ç‰ˆè°ƒç”¨æ–¹å…¨éƒ¨æ”¹ä¸ºé€šè¿‡ `core/agents/router` | ğŸ“‹ å¾…æ’æœŸ |
| Phase 3 | `agents/` ç›®å½•å½’æ¡£, ä»…ä¿ç•™å…¼å®¹æ€§ re-export | ğŸ“‹ å¾…æ’æœŸ |

## ç›¸å…³æ²»ç†æ–‡æ¡£

- **C3** `core/stage_authority.py` â€” é˜¶æ®µé€»è¾‘ç»Ÿä¸€å…¥å£
- **C4** `core/field_sync_guard.py` â€” å­—æ®µåŒæ­¥å®ˆå«
- **CR-31** å¥‘çº¦æ³¨å†Œè¡¨ â€” AgentåŒå±‚æ¶æ„(ç”¨æˆ·å±‚/æ•™ç»ƒå±‚)
- **CR-32** å¥‘çº¦æ³¨å†Œè¡¨ â€” 10é¢†åŸŸÃ—Agentæ˜ å°„
