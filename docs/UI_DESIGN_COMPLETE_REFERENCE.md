# è¡Œä¸ºå¥åº·æ•°å­—å¹³å° â€”â€” UI è®¾è®¡å®Œæ•´å‚è€ƒæ‰‹å†Œ

> ç‰ˆæœ¬: v16.1.0 | æ›´æ–°æ—¥æœŸ: 2026-02-03
> æœ¬æ–‡æ¡£ç»¼åˆã€Œå®Œæ•´æ€»è§ˆã€ä¸ã€Œç»´åº¦æ¸…å•ã€ï¼Œå¯¹æ¯”ä»£ç åº“å®é™…çŠ¶æ€æ›´æ–°ï¼Œ
> ç¡®ä¿ **æ¯ä¸ªé¡µé¢çš„æ¯ä¸ªäº¤äº’æŒ‰é’®éƒ½æœ‰æ˜ç¡®çš„æ•°æ®æºå’Œåç«¯å¯¹æ¥ç‚¹**ã€‚

---

## ä¸€ã€å¹³å°æ¶æ„å±‚æ¬¡ï¼ˆ7 å±‚ â€” å·²éªŒè¯ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ L7  ç”¨æˆ·äº¤äº’å±‚   3å¥—å‰ç«¯ + 1å¥—ä¸“å®¶å·¥ä½œå°                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ L6  æŠ«éœ²æ§åˆ¶å±‚   é»‘åå•è¿‡æ»¤ â†’ AIæ”¹å†™ â†’ åŒç­¾å®¡æ‰¹ â†’ è§’è‰²è§†å›¾        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ L5  è´¨é‡å®¡è®¡å±‚   LLM-as-Judge 4ç»´è¯„åˆ† â†’ PASS/REVIEW/FAIL         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ L4  Agentæ™ºèƒ½å±‚  11ç§ä¸“å®¶Agent + ç¼–æ’è·¯ç”± + Octopusæ•ˆèƒ½é’³åˆ¶        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ L3  ä¸šåŠ¡å¼•æ“å±‚   è¡Œä¸ºè§„åˆ™å¼•æ“ + è§¦å‘è·¯ç”± + èŠ‚å¾‹æ¨¡å‹ + çŠ¶æ€åŒæ­¥     â”‚
â”‚                  â˜… æ–°å¢: TTM Decision Core (SOP 6.2 é˜²ç«å¢™)       â”‚
â”‚                  â˜… æ–°å¢: æˆé•¿ä¹‹æ—…å™äº‹åŒ– (L6 çƒ­é‡å†™)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ L2  æ•°æ®æœåŠ¡å±‚   3å¥—FastAPI + ORM + 19å¼ è¡¨ + JWTè®¤è¯              â”‚
â”‚                  â˜… æ–°å¢3å¼ è¡¨: behavior_traces / behavior_history  â”‚
â”‚                    / behavior_audit_logs                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ L1  åŸºç¡€è®¾æ–½å±‚   Ollama/Dify/Weaviate/SQLite(dev)/Redis/Docker   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å˜æ›´è®°å½•ï¼ˆå¯¹æ¯”åŸæ–‡æ¡£ï¼‰

| é¡¹ç›® | åŸå€¼ | ç°å€¼ | è¯´æ˜ |
|------|------|------|------|
| æ•°æ®è¡¨æ•°é‡ | 16å¼  | **19å¼ ** | æ–°å¢ behavior_traces, behavior_history, behavior_audit_logs |
| L3 ä¸šåŠ¡å¼•æ“ | è§¦å‘è·¯ç”±+èŠ‚å¾‹+è§„åˆ™ | **+TTM Decision Core** | BehavioralBrain ç±»: SOP 6.2 é˜²ç«å¢™ + S2â†’S3 è·ƒè¿ + æˆé•¿ä¹‹æ—…å™äº‹ |
| L6 å™äº‹é£æ ¼ | è‹±é›„ä¹‹æ—… | **æˆé•¿ä¹‹æ—…** | å…¨å¹³å°ç»Ÿä¸€æ›´å |
| API ç«¯ç‚¹æ€»æ•° | ~120 | **138+** | æ–°å¢ /api/v1/brain/evaluate ç­‰ |
| é…ç½®æ–‡ä»¶ | 4å¥— | **5å¥—** | æ–°å¢ configs/spi_mapping.json |

---

## äºŒã€ä¸‰å¥—åç«¯æœåŠ¡ â€” å®Œæ•´ç«¯ç‚¹æ¸…å•

### ç«¯å£ 8000: Agent ç½‘å…³ (api/main.py)

| ç«¯ç‚¹ | æ–¹æ³• | ç”¨é€” | å‰ç«¯è°ƒç”¨æ–¹ |
|------|------|------|-----------|
| `/health` | GET | åŸºç¡€å¥åº·æ£€æŸ¥ | å…¨éƒ¨ |
| `/api/v1/health` | GET | å…¨ä¾èµ–å¥åº·æ£€æŸ¥ | å…¨éƒ¨ |
| `/api/v1/dispatch` | POST | Dify/Ollama è·¯ç”±åˆ†å‘ | h5 Chat |
| `/api/v1/experts` | GET | ä¸“å®¶åˆ—è¡¨ | h5 Chat |
| `/api/v1/dashboard/{user_id}` | GET | ç”¨æˆ·çœ‹æ¿æ•°æ® | h5 Dashboard |
| `/api/v1/decompose` | POST | ä»»åŠ¡åˆ†è§£ | h5 Chat |
| `/api/v1/clamping` | POST | Octopusæ•ˆèƒ½é’³åˆ¶ | h5 Chat |
| `/api/v1/reports/full` | GET | å®Œæ•´æŠ¥å‘Š(æŒ‰X-Roleè¿‡æ»¤) | **h5 Dashboard â˜…å·²ä¿®å¤** |
| **`/api/v1/brain/evaluate`** | **POST** | **TTMé˜¶æ®µè·ƒè¿åˆ¤å®š â˜…æ–°å¢** | **å…­ç±»UIå‡å¯è°ƒç”¨** |
| `/orchestrator/process` | POST | MasterAgent 9æ­¥ç¼–æ’ | admin-portal |
| `/orchestrator/briefing` | POST | æ¯æ—¥æ‘˜è¦ | admin-portal |
| `/orchestrator/agent-task` | POST | å•Agentä»»åŠ¡ | admin-portal |
| `/orchestrator/action-plan` | POST | è¡ŒåŠ¨è®¡åˆ’ | admin-portal |
| `/orchestrator/profile/{user_id}` | GET | ç”¨æˆ·ç”»åƒ | admin-portal |
| `/orchestrator/device-sync` | POST | è®¾å¤‡åŒæ­¥ | admin-portal |
| `/orchestrator/coordinate` | POST | å¤šAgentåè°ƒ | admin-portal |
| `/orchestrator/route` | POST | Agentè·¯ç”±é€‰æ‹© | admin-portal |

### ç«¯å£ 8001: BAPS è¯„ä¼° (api/baps_api.py)

| ç«¯ç‚¹ | æ–¹æ³• | ç”¨é€” |
|------|------|------|
| `/questionnaires` | GET | é‡è¡¨åˆ—è¡¨ |
| `/questionnaires/{type}` | GET | å•ä¸ªé‡è¡¨ |
| `/assess/big_five` | POST | BIG5äººæ ¼ |
| `/assess/bpt6` | POST | BPT-6è¡Œä¸ºæ¨¡å¼ |
| `/assess/capacity` | POST | CAPACITYæ”¹å˜æ½œåŠ› |
| `/assess/spi` | POST | SPIæˆåŠŸå¯èƒ½æ€§ |
| `/assess/comprehensive` | POST | ç»¼åˆè¯„ä¼° |
| `/assess/quick` | POST | å¿«é€Ÿè¯„ä¼° |

### ç«¯å£ 8002: å†³ç­–å¼•æ“ (main.py)

| ç«¯ç‚¹ | æ–¹æ³• | ç”¨é€” | å‰ç«¯è°ƒç”¨æ–¹ |
|------|------|------|-----------|
| `/api/v1/mp/task/today` | GET | ä»Šæ—¥ä»»åŠ¡ | h5-patient, admin-portal(Cç«¯) |
| `/api/v1/mp/task/feedback` | POST | ä»»åŠ¡åé¦ˆ+çŠ¶æ€æœº | h5-patient |
| `/api/v1/mp/agent/respond` | POST | Agent AIå“åº” | h5-patient |
| `/api/v1/mp/user/state` | GET | ç”¨æˆ·çŠ¶æ€ | h5 Home, admin-portal |
| `/api/v1/mp/progress/summary` | GET | è¿›åº¦æ‘˜è¦ | h5 Home |
| `/api/v1/mp/chat` | POST | éæµå¼å¯¹è¯ | h5-patient Chat |
| `/api/v1/mp/chat/stream` | POST | **SSEæµå¼å¯¹è¯** | h5-patient Chat |
| `/api/v1/mp/chat/history/{id}` | GET | èŠå¤©å†å² | h5-patient Chat |
| `/api/v1/mp/chat/sessions` | GET | ä¼šè¯åˆ—è¡¨ | h5-patient Chat |
| `/api/v1/mp/device/*` | å¤šç§ | è®¾å¤‡æ•°æ®(20+ç«¯ç‚¹) | h5-patient HealthData |
| `/api/v1/auth/*` | å¤šç§ | è®¤è¯(ç™»å½•/æ³¨å†Œ/ç™»å‡º) | h5-patient Login |
| `/api/v1/admin/behavior/*` | å¤šç§ | è¡Œä¸ºè§„åˆ™ç®¡ç†(15ç«¯ç‚¹) | admin-portal Admin |
| `/api/v2/disclosure/*` | å¤šç§ | æŠ«éœ²æ§åˆ¶(14ç«¯ç‚¹) | Expertå·¥ä½œå° |
| `/api/v2/quality/*` | å¤šç§ | è´¨é‡å®¡è®¡(8ç«¯ç‚¹) | Expertå·¥ä½œå° |
| `/api/v1/copilot/analyze` | POST | CoachCopilotåˆ†æ | admin-portal Coach |

---

## ä¸‰ã€å…­ç±»ç”¨æˆ·ç•Œé¢ Ã— ç³»ç»Ÿå¯¹æ¥çŸ©é˜µ

> â˜… æ ¸å¿ƒçº¦æŸ: æ¯ä¸ªç•Œé¢åˆ†å‹æœ‰ä¸åŒçš„**æ•°æ®å¯è§æ€§**å’Œ**å†³ç­–æ ¸å¿ƒäº¤äº’æ–¹å¼**

### â‘  å…¬ä¼—ç§‘æ™® (UI-1 â†’ SOP 6.2 é˜²ç«å¢™)

| ç»´åº¦ | è¯´æ˜ |
|------|------|
| æ ¸å¿ƒæœåŠ¡æ¥å£ | `CONTENT_EXPOSURE` â€” ä»…å†…å®¹è§¦è¾¾ |
| å…³é”®æ•°æ®çŠ¶æ€ | åŒ¿å/éšæ€§é‡‡é›† |
| Decision Core äº¤äº’ | **SILENCE** â€” `/api/v1/brain/evaluate` + `X-Source-UI: UI-1` â†’ è¿”å› SILENCEï¼Œä¸è§¦å‘å†³ç­–é€»è¾‘ |
| UI å‘ˆç° | å¥åº·ç§‘æ™®æ–‡ç« ã€è§†é¢‘ã€äº’åŠ¨é—®ç­”ï¼›æ— éœ€ç™»å½•ï¼›ä¸æ˜¾ç¤ºä¸ªäººæ•°æ® |
| å¯¹åº”å‰ç«¯ | h5 (5173) æœªç™»å½•æ€ / ç‹¬ç«‹H5é¡µé¢ |

### â‘¡ å¿«é€Ÿæµ‹è¯„ (UI-2)

| ç»´åº¦ | è¯´æ˜ |
|------|------|
| æ ¸å¿ƒæœåŠ¡æ¥å£ | `SELF_REPORT` |
| å…³é”®æ•°æ®çŠ¶æ€ | `UNVERIFIED_INSIGHT` â€” æ•°æ®ä»…ä¾›å†³ç­–æ ¸å¿ƒå‚è€ƒï¼Œæš‚ä¸è¿›å…¥æ•™ç»ƒè§†å›¾ |
| Decision Core äº¤äº’ | è¯„ä¼°ç»“æœå†™å…¥ behavior_tracesï¼Œä½†æ ‡è®°ä¸º unverified |
| UI å‘ˆç° | é‡è¡¨é—®å·(PHQ-9/GAD-7/PSS-10ç­‰)ã€å³æ—¶ç»“æœã€å»ºè®®ï¼›ä¿éšœ"å¯é€†æ€§"æ¢ç´¢ |
| å¯¹åº”å‰ç«¯ | h5-patient-app (5175) DataInput â†’ Result |
| åç«¯ç«¯ç‚¹ | `/api/assessment/submit`, `/assess/quick`, `/assess/comprehensive` |

### â‘¢ è¡Œä¸ºé™ªä¼´ (UI-3 â†’ è§¦å‘ Decision Core)

| ç»´åº¦ | è¯´æ˜ |
|------|------|
| æ ¸å¿ƒæœåŠ¡æ¥å£ | `TASK_FEEDBACK` |
| å…³é”®æ•°æ®çŠ¶æ€ | `ACTION_VERIFIED` â€” è®¾å¤‡+è¡Œä¸ºåŒé‡ç¡®è®¤ |
| Decision Core äº¤äº’ | `/api/v1/brain/evaluate` + `X-Source-UI: UI-3` â†’ å¯è§¦å‘é˜¶æ®µè·ƒè¿(å¦‚ S2â†’S3) |
| UI å‘ˆç° | ä»»åŠ¡å¡ç‰‡ã€æ‰“å¡ã€æˆé•¿ä¹‹æ—…å™äº‹ã€æ•ˆèƒ½æ»‘å—ã€å¯ç©¿æˆ´æ•°æ®é¢æ¿ |
| å¯¹åº”å‰ç«¯ | h5 (5173) Home + Chat + Tasks + Dashboard |
| åç«¯ç«¯ç‚¹ | `/api/v1/dispatch`, `/api/v1/decompose`, `/api/v1/clamping`, `/api/v1/mp/task/*` |
| å®æ—¶æ€§ | é«˜é¢‘å¯¹æ¥CGM/HRV â€” `/api/v1/mp/device/*`, 10ç§’è½®è¯¢ |

### â‘£ æ•™ç»ƒå° (UI-4)

| ç»´åº¦ | è¯´æ˜ |
|------|------|
| æ ¸å¿ƒæœåŠ¡æ¥å£ | `DECISION_SUPPORT` |
| å…³é”®æ•°æ®çŠ¶æ€ | è¡Œä¸ºè¯­ä¹‰å±‚ç»“æœ(éåŸå§‹æµ‹è¯„é¢˜) |
| Decision Core äº¤äº’ | åªè¯»æ¶ˆè´¹ â€” æŸ¥çœ‹è·ƒè¿ç»“æœã€é£é™©ç­‰çº§ã€å»ºè®®åŠ¨ä½œ |
| å…³é”®çº¦æŸ | **æ•™ç»ƒä¸å¯è§åŸå§‹æµ‹è¯„é¢˜**ï¼Œä»…å¯è§ç³»ç»Ÿç”Ÿæˆçš„è¯­ä¹‰åŒ–å»ºè®® |
| UI å‘ˆç° | å­¦å‘˜çœ‹æ¿ã€Copilotå¤„æ–¹æ¨é€(SSE)ã€å·¥å…·ç®±(å‹åŠ›æµ‹è¯„/å…±æƒ…å¼•å¯¼/ä¹ æƒ¯å¤„æ–¹)ã€å†…å®¹åˆ†äº« |
| å¯¹åº”å‰ç«¯ | admin-portal (5174) Coachæ¨¡å— |
| åç«¯ç«¯ç‚¹ | `/api/v1/copilot/analyze`, `/orchestrator/process`, SSE stream |

### â‘¤ ä¸“å®¶ç£å¯¼ (UI-5)

| ç»´åº¦ | è¯´æ˜ |
|------|------|
| æ ¸å¿ƒæœåŠ¡æ¥å£ | `DECISION_TRACE` |
| å…³é”®æ•°æ®çŠ¶æ€ | å†³ç­–å…¨è·¯å¾„å›æ”¾(è¾“å…¥â†’åˆ¤å®šâ†’è¾“å‡º) |
| Decision Core äº¤äº’ | å¯è¦†å†™ TTM é˜¶æ®µ/é£é™©ç­‰çº§ï¼›trace_id åæŸ¥å®Œæ•´å†³ç­–é“¾ |
| UI å‘ˆç° | åŒé¢æ¿(ä¸“å®¶ä¾§åŸå§‹æ•°æ® / æ‚£è€…ä¾§è„±æ•é¢„è§ˆ)ã€æ•æ„Ÿè¯æ ‡æ³¨ã€åŒç­¾å®¡æ‰¹ã€ç£å¯¼ä¼šè¯ |
| å¯¹åº”å‰ç«¯ | admin-portal (5174) Expertæ¨¡å— + Streamlitå·¥ä½œå° (8501) |
| åç«¯ç«¯ç‚¹ | `/api/v2/disclosure/*`, `/api/v2/quality/*`, `/api/v1/admin/behavior/*` |

### â‘¥ å¹³å°è¿›åŒ– (UI-6)

| ç»´åº¦ | è¯´æ˜ |
|------|------|
| æ ¸å¿ƒæœåŠ¡æ¥å£ | `ANALYTICS_API` |
| å…³é”®æ•°æ®çŠ¶æ€ | é˜¶æ®µè¿ç§»ç‡/å¤å‘ç‡/å…¨é‡ç»Ÿè®¡ |
| Decision Core äº¤äº’ | æ±‡æ€» behavior_traces + behavior_history è¿›è¡Œç›²åŒºåˆ†æ |
| UI å‘ˆç° | å…¨å±€æ•°æ®åˆ†æã€è¡Œä¸ºè§„åˆ™åº“ç¼–è¾‘ã€é…ç½®çƒ­åŠ è½½ã€å®¡è®¡æ—¥å¿— |
| å¯¹åº”å‰ç«¯ | admin-portal (5174) Adminæ¨¡å— |
| åç«¯ç«¯ç‚¹ | `/api/v1/admin/behavior/rules`, `/api/v1/admin/behavior/stats` |

---

## å››ã€å…¨ç³»ç»Ÿé¡µé¢äº¤äº’æ¸…å•ï¼ˆ76é¡µ â€” é€é¡µéªŒè¯ï¼‰

> âœ… = äº¤äº’æ­£å¸¸  |  ğŸ”§ = æœ¬æ¬¡ä¿®å¤  |  âš ï¸ = éœ€å…³æ³¨

### 4.1 h5 æ‚£è€…ç«¯ (localhost:5173) â€” 5 é¡µ

| é¡µé¢ | è·¯ç”± | äº¤äº’å…ƒç´  | æ•°æ®æº | çŠ¶æ€ |
|------|------|---------|--------|------|
| **é¦–é¡µ** | `/` | ä¸“å®¶å¡ç‰‡â†’è·³Chat | `/api/v1/mp/user/state`, `/latest_status` | âœ… |
| | | å¿«æ·å…¥å£(4å®«æ ¼) | è·¯ç”±è·³è½¬ | âœ… |
| | | ä»Šæ—¥ä»»åŠ¡(3æ¡) | Storeç¼“å­˜ | âœ… |
| | | å¥åº·æŒ‡æ ‡å¡ç‰‡ | `/api/v1/mp/progress/summary` | âœ… |
| | | ç”¨è¯æé†’å¼¹çª— | Mockæ•°æ®(äºŒç”²åŒèƒç­‰) | âš ï¸ éœ€å¯¹æ¥çœŸå®å¤„æ–¹ |
| **å¯¹è¯** | `/chat` | æ¶ˆæ¯å‘é€ | `POST /api/v1/dispatch` | âœ… |
| | | ä¸“å®¶åˆ‡æ¢ | Store.setCurrentExpert | âœ… |
| | | æ•ˆèƒ½æ»‘å— | Store.setEfficacyScore | âœ… |
| | | ç©¿æˆ´æ•°æ®è¾“å…¥ | Store.updateWearableData | âœ… |
| | | ä»»åŠ¡å¡ç‰‡(å†…åµŒ) | `/api/v1/decompose` | âœ… |
| **ä»»åŠ¡** | `/tasks` | å®Œæˆæ‰“å‹¾ | Store.toggleTaskComplete | âœ… |
| | | ç±»å‹ç­›é€‰ | æœ¬åœ°è¿‡æ»¤ | âœ… |
| | | ç©ºæ€â†’è·³Chat | è·¯ç”±è·³è½¬ | âœ… |
| **çœ‹æ¿** | `/dashboard` | è¯„åˆ†å¡ç‰‡ | `GET /api/v1/dashboard/{userId}` | âœ… |
| | | è¶‹åŠ¿å›¾è¡¨ | EChartsæ¸²æŸ“ | âœ… |
| | | é£é™©è¯„ä¼° | dashboardData.risk_level | âœ… |
| | | **æŸ¥çœ‹å®Œæ•´æŠ¥å‘Š** | **`GET /api/v1/reports/full` + X-Role: patient** | **ğŸ”§ å·²ä¿®å¤** |
| **æˆ‘çš„** | `/profile` | ç©¿æˆ´æ•°æ®å±•ç¤º | Store.wearableData | âœ… |
| | | èœå•é¡¹(7é¡¹) | showToastå ä½ | âš ï¸ å¥åº·æ¡£æ¡ˆ/å†å²æŠ¥å‘Šéœ€å¯¹æ¥ |
| | | é€€å‡ºç™»å½• | æ¸…é™¤Store | âœ… |

### 4.2 h5-patient-app æ‚£è€…ç«¯ (localhost:5175) â€” 10 é¡µ

| é¡µé¢ | è·¯ç”± | äº¤äº’å…ƒç´  | æ•°æ®æº | çŠ¶æ€ |
|------|------|---------|--------|------|
| **ç™»å½•** | `/login` | ç™»å½•è¡¨å• | `POST /api/v1/auth/login` | âœ… |
| | | è·³æ³¨å†Œ | è·¯ç”±è·³è½¬ | âœ… |
| **æ³¨å†Œ** | `/register` | æ³¨å†Œè¡¨å• | `POST /api/v1/auth/register` | âœ… |
| **é¦–é¡µ** | `/` | å¿«æ·å…¥å£(6å®«æ ¼) | è·¯ç”±è·³è½¬ | âœ… |
| | | æœ€è¿‘è¯„ä¼°åˆ—è¡¨ | `/api/assessment/recent/{userId}` | âœ… |
| | | ç‚¹å‡»è¯„ä¼°â†’ç»“æœ | `/result/{id}` | âœ… |
| | | é€€å‡ºç™»å½• | authStore.logout | âœ… |
| **æ•°æ®å½•å…¥** | `/data-input` | æƒ…ç»ªæ—¥è®°+è¡€ç³–+HRVè¡¨å• | `POST /api/assessment/submit` | âœ… |
| | | æäº¤â†’è·³ç»“æœ | `/result/{id}` | âœ… |
| **è¯„ä¼°ç»“æœ** | `/result/:id` | é£é™©ç­‰çº§å±•ç¤º | assessmentStore.fetchResult | âœ… |
| | | ç»§ç»­è¯„ä¼° | `/data-input` | âœ… |
| | | è¿”å›é¦–é¡µ | `/` | âœ… |
| **è¯„ä¼°å†å²** | `/history` | æ— é™æ»šåŠ¨åˆ—è¡¨ | `/api/assessment/history/{userId}` | âœ… |
| | | ç‚¹å‡»è¯¦æƒ… | `/result/{id}` | âœ… |
| **æ•°æ®åˆ†æ** | `/analysis` | ç»Ÿè®¡å›¾è¡¨ | æœ¬åœ°è®¡ç®— | âœ… |
| | | ç©ºæ€â†’å½•å…¥ | `/data-input` | âœ… |
| **AIåŠ©æ‰‹** | `/chat` | æ¶ˆæ¯å‘é€(æµå¼) | `POST /api/v1/mp/chat/stream` (SSE) | âœ… |
| | | å¿«æ·å»ºè®® | handleQuickSend | âœ… |
| | | æ¸…ç©ºå¯¹è¯ | chatStore.clearMessages | âœ… |
| **å¥åº·æ•°æ®** | `/health-data` | è¡€ç³–è®°å½•å¼¹çª— | `POST /mp/device/glucose/manual` | âœ… |
| | | ä½“é‡è®°å½•å¼¹çª— | `POST /mp/device/weight` | âœ… |
| | | è¡€å‹è®°å½•å¼¹çª— | `POST /mp/device/blood-pressure` | âœ… |
| | | è®¾å¤‡ä»ªè¡¨ç›˜ | `/mp/device/dashboard/today` | âœ… |
| **è®¾ç½®** | `/settings` | é€€å‡ºç™»å½• | authStore.logout â†’ `/login` | âœ… |
| | | æ¸…é™¤ç¼“å­˜ | localStorageæ¸…ç† | âœ… |
| | | å…³äº/åè®®/éšç§ | Dialogå¼¹çª— | âœ… |

### 4.3 admin-portal ç®¡ç†ç«¯ (localhost:5174) â€” 50+ é¡µ

#### Patient(Cç«¯)æ¨¡å— â€” 11 é¡µ

| é¡µé¢ | è·¯ç”± | å…³é”®äº¤äº’ | çŠ¶æ€ |
|------|------|---------|------|
| Cç«¯é¦–é¡µ | `/client` | ä»»åŠ¡åˆ—è¡¨+å¥åº·æ‘˜è¦ | âœ… |
| Cç«¯å¯¹è¯ | `/client/chat` | Dify/OllamaåŒæ¨¡å¼ | âœ… |
| æˆ‘çš„èµ„æ–™ | `/client/my-profile` | ä¸ªäººä¿¡æ¯å±•ç¤º | âœ… |
| æˆ‘çš„è®¾å¤‡ | `/client/my-devices` | è®¾å¤‡ç»‘å®š/è§£ç»‘ | âœ… |
| æˆ‘çš„è¯„ä¼° | `/client/my-assessments` | è¯„ä¼°å†å²åˆ—è¡¨ | âœ… |
| æˆ‘çš„è½¨è¿¹ | `/client/my-trajectory` | è¡Œä¸ºè½¨è¿¹å¯è§†åŒ– | âœ… |
| è®¾å¤‡é¢æ¿ | `/client/device-dashboard` | å®æ—¶è®¾å¤‡æ•°æ® | âœ… |
| è¯„ä¼°åˆ—è¡¨ | `/client/assessment-list` | å¯ç”¨é‡è¡¨åˆ—è¡¨ | âœ… |
| åšè¯„ä¼° | `/client/take-assessment/:id` | é‡è¡¨ç­”é¢˜ | âœ… |
| è¯„ä¼°ç»“æœ | `/client/assessment-result/:id` | ç»“æœå±•ç¤º | âœ… |
| å­¦ä¹ è¿›åº¦ | `/client/learning-progress` | è¯¾ç¨‹è¿›åº¦ | âœ… |

#### Coach æ¨¡å— â€” 15 é¡µ

| é¡µé¢ | è·¯ç”± | å…³é”®äº¤äº’ | çŠ¶æ€ |
|------|------|---------|------|
| æ•™ç»ƒé¦–é¡µ | `/coach-portal` | å­¦å‘˜çœ‹æ¿+å¾…åŠ | âœ… |
| æ•™ç»ƒåˆ—è¡¨ | `/coach/list` | åˆ†é¡µ+ç­›é€‰ | âœ… |
| æ•™ç»ƒè¯¦æƒ… | `/coach/detail/:id` | ç»©æ•ˆæ•°æ® | âœ… |
| æ™‹çº§å®¡æ ¸ | `/coach/review` | å®¡æ ¸é€šè¿‡/æ‹’ç» | âœ… |
| å­¦å‘˜ç®¡ç† | `/student` | å­¦å‘˜CRUD | âœ… |
| æˆ‘çš„å­¦å‘˜ | `/coach/my/students` | æŒ‰TTMé˜¶æ®µåˆ†ç»„ | âœ… |
| æˆ‘çš„ç»©æ•ˆ | `/coach/my/performance` | æˆåŠŸç‡/ç•™å­˜/å“åº”æ—¶é—´ | âœ… |
| æˆ‘çš„è®¤è¯ | `/coach/my/certification` | ç­‰çº§+æ™‹å‡è¿›åº¦ | âœ… |
| æˆ‘çš„å·¥å…·ç®± | `/coach/my/tools` | å‹åŠ›/å…±æƒ…/ä¹ æƒ¯3ç§å·¥å…· | âœ… |
| å†…å®¹åˆ†äº« | `/coach/content-sharing` | é€‰å†…å®¹â†’é€‰å­¦å‘˜â†’å‘é€ | âœ… |
| å­¦å‘˜æµ‹è¯„ | `/coach/student-assessment/:id` | ç­”é¢˜å›é¡¾+æ‰¹æ³¨ | âœ… |
| CoachCopilot | å†…åµŒç»„ä»¶ | SSEå¤„æ–¹æ¨é€+é‡‡çº³/å¿½ç•¥ | âœ… |
| å‹åŠ›æµ‹è¯„è¡¨ | å·¥å…·ç®±å†… | 8é¢˜æ»‘å—è¯„ä¼° | âœ… |
| å…±æƒ…å¼•å¯¼å¡ | å·¥å…·ç®±å†… | OARSè¯æœ¯ | âœ… |
| ä¹ æƒ¯å¤„æ–¹å¡ | å·¥å…·ç®±å†… | SMARTç›®æ ‡ç”Ÿæˆ | âœ… |

#### Expert æ¨¡å— â€” 4 é¡µ

| é¡µé¢ | è·¯ç”± | å…³é”®äº¤äº’ | çŠ¶æ€ |
|------|------|---------|------|
| ä¸“å®¶é¦–é¡µ | `/expert-portal` | ä»»åŠ¡é˜Ÿåˆ—+é£é™©æ’åº | âœ… |
| æˆ‘çš„ç£å¯¼ | `/expert/my/supervision` | è¢«ç£å¯¼æ•™ç»ƒåˆ—è¡¨ | âœ… |
| æˆ‘çš„å®¡æ ¸ | `/expert/my/reviews` | å®¡æ ¸é˜Ÿåˆ— | âœ… |
| ç ”ç©¶æ•°æ® | `/expert/my/research` | è„±æ•ç»Ÿè®¡+å¯¼å‡º | âœ… |

#### Admin/å†…å®¹ç®¡ç† â€” 20+ é¡µ

| é¡µé¢ | è·¯ç”± | å…³é”®äº¤äº’ | çŠ¶æ€ |
|------|------|---------|------|
| ä»ªè¡¨ç›˜ | `/dashboard` | å…¨å±€ç»Ÿè®¡ | âœ… |
| è¯¾ç¨‹åˆ—è¡¨ | `/course/list` | CRUD | âœ… |
| è¯¾ç¨‹ç¼–è¾‘ | `/course/edit/:id` | è¡¨å• | âœ… |
| ç« èŠ‚ç®¡ç† | `/course/chapters/:courseId` | æ’åº+ç¼–è¾‘ | âœ… |
| é¢˜åº“åˆ—è¡¨ | `/question/bank` | ç­›é€‰+æ‰¹é‡å¯¼å…¥ | âœ… |
| é¢˜ç›®ç¼–è¾‘ | `/question/edit/:id` | å•é€‰/å¤šé€‰/åˆ¤æ–­/ç®€ç­” | âœ… |
| è€ƒè¯•åˆ—è¡¨ | `/exam/list` | å‘å¸ƒ/å½’æ¡£ | âœ… |
| è€ƒè¯•ç¼–è¾‘ | `/exam/edit/:id` | é€‰é¢˜+é…ç½® | âœ… |
| è€ƒè¯•ç›‘è€ƒ | `/exam/session/:id` | å…¨å±+é˜²ä½œå¼Š | âœ… |
| æˆç»©æŸ¥çœ‹ | `/exam/results/:examId` | ç»Ÿè®¡+å¯¼å‡º | âœ… |
| ç›‘è€ƒå›é¡¾ | `/exam/proctor-review` | å¼‚å¸¸è¡Œä¸ºå®¡æŸ¥ | âœ… |
| ç›´æ’­åˆ—è¡¨ | `/live/list` | æ’æœŸç®¡ç† | âœ… |
| ç›´æ’­ç¼–è¾‘ | `/live/edit/:id` | é…ç½® | âœ… |
| Promptåˆ—è¡¨ | `/prompts/list` | æ¨¡æ¿ç®¡ç† | âœ… |
| Promptç¼–è¾‘ | `/prompts/edit/:id` | å˜é‡æ’å€¼ | âœ… |
| å¹²é¢„åŒ…ç®¡ç† | `/interventions` | 7ç§å¹²é¢„åŒ… | âœ… |
| ç”¨æˆ·ç®¡ç† | `/admin/user-management` | CRUD+è§’è‰²åˆ†é… | âœ… |
| åˆ†é…ç®¡ç† | `/admin/distribution` | æ‚£è€…-æ•™ç»ƒåˆ†é… | âœ… |
| ç³»ç»Ÿè®¾ç½® | `/settings` | å…¨å±€é…ç½® | âœ… |

---

## äº”ã€æ–°å¢æ ¸å¿ƒæ¨¡å—ï¼šTTM Decision Core

### 5.1 ç«¯ç‚¹: `/api/v1/brain/evaluate`

```
è¯·æ±‚:
  POST /api/v1/brain/evaluate
  Header: X-Source-UI: UI-1 | UI-2 | UI-3 | UI-4 | UI-5 | UI-6
  Body: {
    "user_id": "string",
    "current_stage": "S0-S5",
    "belief": 0.0-1.0,
    "action_count_3d": int
  }

å“åº” (UI-1, SOP 6.2 é˜²ç«å¢™):
  {"action": "SILENCE", "bypass_brain": true, "source": "UI-1", "reason": "SOP 6.2"}

å“åº” (UI-3, è·ƒè¿è§¦å‘):
  {
    "from_stage": "S2", "to_stage": "S3", "is_transition": true,
    "timestamp": "...", "spi_summary": {"belief": 0.8, "actions": 2},
    "narrative": "ä½ å·²ç»èµ°è¿‡äº†å‡†å¤‡æœŸçš„è€ƒéªŒ...è¿™æ˜¯æˆé•¿ä¹‹æ—…ä¸­æœ€å…³é”®çš„ä¸€æ­¥..."
  }
```

### 5.2 å¼‚æ­¥æŒä¹…åŒ– (BackgroundTasks)

æ¯æ¬¡è°ƒç”¨ brain/evaluate åå°å†™å…¥ 3 å¼ è¡¨:

| è¡¨å | å†™å…¥æ¡ä»¶ | å­—æ®µ |
|------|---------|------|
| behavior_traces | æ¯æ¬¡ | user_id, from_stage, to_stage, belief_score, action_count, source_ui, narrative_sent |
| behavior_history | æ¯æ¬¡ | user_id, from_stage, to_stage, is_transition, belief_score |
| behavior_audit_logs | ä»…è·ƒè¿æ—¶ | user_id, from_stage, to_stage, narrative, source_ui |

### 5.3 å‘¨æŠ¥å™äº‹ (Weekly Insight)

```
BehavioralBrain.analyze_weekly_trend(user_id)  â€” åŒæ­¥, DBæŸ¥è¯¢
BehavioralBrain.generate_weekly_insight(history) â€” å¼‚æ­¥, é¢„å–åˆ—è¡¨

ä¸‰çº§å™äº‹:
  æœ‰è·ƒè¿ â†’ "è¿™æ˜¯å€¼å¾—é“­è®°çš„ä¸€å‘¨ï¼ä½ åœ¨ {date} å®Œæˆäº†ä» {S2} åˆ° {S3} çš„è·¨è¶Šã€‚"
  é«˜ä¿¡å¿µæ— è·ƒè¿ â†’ "ä½ çš„ä¿¡å¿µæŒ‡æ•°æŒç»­å¤„äºé«˜ä½ï¼Œæ­£å¦‚é»æ˜å‰çš„æ›™å…‰ã€‚"
  æ²‰æ·€æœŸ â†’ "è‹±é›„åœ¨è¡ŒåŠ¨å‰ï¼Œæ€»éœ€è¦æ¼«é•¿çš„å†¥æƒ³æ¥ç§¯è“„åŠ›é‡ã€‚"
```

---

## å…­ã€19 å¼ æ•°æ®è¡¨å®Œæ•´æ¸…å•

| # | è¡¨å | é¢†åŸŸ | è¯´æ˜ |
|---|------|------|------|
| 1 | users | ç”¨æˆ· | è´¦æˆ·+è§’è‰² |
| 2 | user_sessions | ç”¨æˆ· | ä¼šè¯ç®¡ç† |
| 3 | assessments | è¯„ä¼° | è¯„ä¼°è®°å½• |
| 4 | trigger_records | è¯„ä¼° | è§¦å‘äº‹ä»¶ |
| 5 | interventions | è¯„ä¼° | å¹²é¢„è®°å½• |
| 6 | health_data | å¥åº· | å¥åº·æ•°æ® |
| 7 | user_devices | å¥åº· | è®¾å¤‡ç»‘å®š |
| 8 | glucose_readings | å¥åº· | è¡€ç³–è¯»æ•° |
| 9 | heart_rate_readings | å¥åº· | å¿ƒç‡è¯»æ•° |
| 10 | hrv_readings | å¥åº· | HRVè¯»æ•° |
| 11 | sleep_records | å¥åº· | ç¡çœ è®°å½• |
| 12 | activity_records | å¥åº· | æ´»åŠ¨è®°å½• |
| 13 | workout_records | å¥åº· | è¿åŠ¨è®°å½• |
| 14 | vital_signs | å¥åº· | ç”Ÿå‘½ä½“å¾ |
| 15 | chat_sessions | å¯¹è¯ | èŠå¤©ä¼šè¯ |
| 16 | chat_messages | å¯¹è¯ | èŠå¤©æ¶ˆæ¯ |
| **17** | **behavior_traces** | **è¡Œä¸º â˜…æ–°** | **é•¿æœŸè®°å¿†å¿«ç…§(å‘¨æŠ¥æ•°æ®æº)** |
| **18** | **behavior_history** | **è¡Œä¸º â˜…æ–°** | **å…¨é‡è¯„ä¼°å†å²** |
| **19** | **behavior_audit_logs** | **è¡Œä¸º â˜…æ–°** | **è·ƒè¿å®¡è®¡æ—¥å¿—** |

---

## ä¸ƒã€è§’è‰²æƒé™çŸ©é˜µï¼ˆå·²éªŒè¯ï¼‰

```
                    Patient    Coach     Expert    Admin
                    â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€     â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€
æŸ¥çœ‹è‡ªèº«å¥åº·æ•°æ®      âœ“
å®Œæˆé—®å·/æ‰“å¡         âœ“
AIå¯¹è¯               âœ“
æŸ¥çœ‹å®Œæ•´æŠ¥å‘Š(3ç« )     âœ“                                    â˜… å·²ä¿®å¤æŒ‰é’®
æŸ¥çœ‹å­¦å‘˜æ•°æ®                    âœ“
ä½¿ç”¨å¹²é¢„å·¥å…·                    âœ“
å†…å®¹åˆ†äº«                        âœ“
CoachCopilot(SSE)              âœ“
æŸ¥çœ‹BIG5/BPT6/TTM              âœ“         âœ“
åˆ›å»ºå¹²é¢„è®¡åˆ’                    âœ“
ç£å¯¼æ•™ç»ƒ                                  âœ“
å®¡æ ¸æ™‹çº§/å†…å®¹                             âœ“
è¦†å†™TTM/é£é™©ç­‰çº§                          âœ“
åŒç­¾å‘å¸ƒæŠ¥å‘Š                              âœ“
æŸ¥çœ‹åŸå§‹ç²¾ç¥å¥åº·                           âœ“
å¯¼å‡ºç ”ç©¶æ•°æ®                              âœ“
ç”¨æˆ·CRUD                                            âœ“
æ‚£è€…-æ•™ç»ƒåˆ†é…                                        âœ“
ç³»ç»Ÿé…ç½®                                            âœ“
è¡Œä¸ºè§„åˆ™åº“ç¼–è¾‘                                       âœ“
å®¡è®¡æ—¥å¿—                                            âœ“
```

---

## å…«ã€é…ç½®æ–‡ä»¶ä½“ç³»ï¼ˆ5 å¥—ï¼‰

| æ–‡ä»¶ | è·¯å¾„ | ç”¨é€” | çƒ­åŠ è½½ |
|------|------|------|--------|
| spi_mapping.json | configs/ | SPIç»´åº¦+TTMè·ƒè¿é˜ˆå€¼ | **â˜…æ–°å¢** |
| behavior_rules.json | configs/behavior/ | é˜¶æ®µå®šä¹‰+è§¦å‘è§„åˆ™+å†·å´ | 30ç§’è½®è¯¢ |
| actions_master.json | services/logic_engine/resource/ | è§¦å‘â†’æ•™ç»ƒæŒ‡ä»¤+é™ªä¼´è¯æœ¯ | 30ç§’è½®è¯¢ |
| diagnosis_prompts_complete.json | configs/assessment/ | ä¸‰åˆä¸€è¯Šæ–­+å¿ƒç†å±‚çº§ | å¯åŠ¨åŠ è½½ |
| spi_implicit_mapping_complete.json | configs/assessment/ | 50é¢˜â†’6æ•°æ®æºéšå¼æ˜ å°„ | å¯åŠ¨åŠ è½½ |

---

## ä¹ã€æŠ€æœ¯ç»´åº¦æ±‡æ€»ï¼ˆæ›´æ–°ç‰ˆï¼‰

| ç»´åº¦ | å…³é”®æ•°å­— |
|------|---------|
| åç«¯æœåŠ¡ | 3å¥—FastAPI (8000/8001/8002) + 1å¥—Streamlit (8501) |
| å‰ç«¯åº”ç”¨ | 3å¥—Vue3 (5173/5174/5175) |
| **æ•°æ®è¡¨** | **19å¼ ** (ç”¨æˆ·2 + è¯„ä¼°3 + è®¾å¤‡9 + å¯¹è¯2 + **è¡Œä¸º3**) |
| **APIç«¯ç‚¹** | **138+** (å«brain/evaluate + è¡Œä¸ºç®¡ç†) |
| AI Agent | 11ç§ä¸“å®¶ + MasterAgentç¼–æ’ + SafetyAgent |
| æ ‡å‡†é‡è¡¨ | 4å¥—BAPS + 8å¥—ä¸´åºŠç­›æŸ¥ |
| TTMé˜¶æ®µ | 6çº§ (S0-S5) |
| é£é™©ç­‰çº§ | 5çº§ (R0-R4) |
| å¿ƒç†å±‚çº§ | 5çº§ (L1-L5) |
| æ•™ç»ƒç­‰çº§ | 5çº§ (L0-L4) |
| è§¦å‘åŸŸ | 7ä¸ª (è¡€ç³–/é¥®é£Ÿ/è¿åŠ¨/ç”¨è¯/ç¡çœ /å‹åŠ›/ä½“é‡) |
| æŠ¥å‘Šç« èŠ‚ | 17ç« , 4çº§å¯è§æ€§ |
| **é…ç½®æ–‡ä»¶** | **5å¥—JSON**, 30ç§’çƒ­åŠ è½½ |
| v14åŠŸèƒ½å¼€å…³ | 7ä¸ª (è§¦å‘è·¯ç”±/èŠ‚å¾‹/Agent/æŠ«éœ²/é»‘åå•/åŒç­¾/å®¡è®¡) |
| DockeræœåŠ¡ | 11ä¸ª (Dify 8 + åº”ç”¨ 3), çº¦38GBå†…å­˜ |
| **å™äº‹é£æ ¼** | **æˆé•¿ä¹‹æ—…** (å…¨å¹³å°ç»Ÿä¸€) |

---

## åã€Pinia Store å…¨æ™¯

### h5 (5173) â€” 2 ä¸ª Store

| Store | æ–‡ä»¶ | æŒä¹…åŒ–é”® | æ ¸å¿ƒçŠ¶æ€ |
|-------|------|---------|---------|
| user | stores/user.ts | xingjian_user_id/name/efficacy/wearable | userId, efficacyScore, wearableData |
| chat | stores/chat.ts | xingjian_chat_messages/tasks | messages[], tasks[], experts[], currentExpert |

### h5-patient-app (5175) â€” 4 ä¸ª Store

| Store | æ–‡ä»¶ | æ ¸å¿ƒçŠ¶æ€ |
|-------|------|---------|
| user | stores/user.ts | user, token, loading |
| assessment | stores/assessment.ts | currentAssessment, history, recentList |
| chat | stores/chat.ts | messages, sessionId, llmHealth, streamingContent, sessions |
| device | stores/device.ts | devices, glucoseReadings, weightRecords, bpRecords, dashboard, sleep, activity, hr, hrv |

### admin-portal (5174) â€” 4 ä¸ª Store

| Store | æ–‡ä»¶ | æ ¸å¿ƒçŠ¶æ€ |
|-------|------|---------|
| auth | stores/auth.ts | token, user, isLoggedIn, isAdmin/Expert/Coach |
| exam | stores/exam.ts | exams[], currentExam, statistics |
| question | stores/question.ts | questions[], currentQuestion |
| agent | stores/agent.ts | agents[], pendingReviews[], currentOutput |

---

## åä¸€ã€å…±äº«ç»„ä»¶åº“

| ç»„ä»¶ | ä½ç½® | ç”¨é€” | ä½¿ç”¨é¡µé¢ |
|------|------|------|---------|
| RiskLevelTag | admin-portal/components | R0-R4é£é™©æ ‡ç­¾(é¢œè‰²ç¼–ç ) | å­¦å‘˜ç®¡ç†/æ•™ç»ƒè¯¦æƒ… |
| CoachLevelBadge | admin-portal/components | L0-L4æ•™ç»ƒç­‰çº§å¾½ç«  | æ•™ç»ƒåˆ—è¡¨/è®¤è¯ |
| BehaviorStageTag | admin-portal/components | S0-S5è¡Œä¸ºé˜¶æ®µæ ‡ç­¾ | å­¦å‘˜çœ‹æ¿/è¯„ä¼°ç»“æœ |
| TriggerDomainTag | admin-portal/components | è§¦å‘åŸŸæ ‡ç­¾ | å¹²é¢„åŒ…/è§¦å‘è®°å½• |
| AIChatBox | admin-portal/components | AIå¯¹è¯æ°”æ³¡ç»„ä»¶ | Cç«¯å¯¹è¯/Copilot |
| AgentSuggestionCard | admin-portal/components/agent | Agentå»ºè®®å¡ç‰‡ | Copilot/ä¸“å®¶å®¡æ ¸ |
| ViolationWarning | admin-portal/components/exam | è€ƒè¯•è¿è§„è­¦å‘Š | è€ƒè¯•ç›‘è€ƒ |
| ProctorCamera | admin-portal/components/exam | ç›‘è€ƒæ‘„åƒå¤´ | è€ƒè¯•ç›‘è€ƒ |
| TabBar | h5/components/common | åº•éƒ¨å¯¼èˆª(5é¡¹) | h5å…¨éƒ¨é¡µé¢ |
| TaskCard | h5/components/chat | ä»»åŠ¡å¡ç‰‡ | å¯¹è¯/ä»»åŠ¡é¡µ |
| MessageBubble | h5/components/chat | æ¶ˆæ¯æ°”æ³¡ | å¯¹è¯é¡µ |
| EfficacySlider | h5/components/chat | æ•ˆèƒ½æ»‘å— | å¯¹è¯é¡µ |
| RiskCard | h5-patient/components | é£é™©ç­‰çº§å¡ | è¯„ä¼°ç»“æœ |
| TriggerList | h5-patient/components | è§¦å‘ä¿¡å·åˆ—è¡¨ | è¯„ä¼°ç»“æœ |

---

## åäºŒã€æœ¬æ¬¡ä¿®å¤çš„äº¤äº’é—®é¢˜

### 12.1 "æŸ¥çœ‹å®Œæ•´æŠ¥å‘Š"æŒ‰é’®æ— å“åº” â€” å·²ä¿®å¤

**æ–‡ä»¶:** `h5/src/views/Dashboard.vue`

**é—®é¢˜:** `<van-button>` æ²¡æœ‰ `@click` äº‹ä»¶ç»‘å®šï¼Œ`report.ts` ä¸­çš„ `fetchFullReport()` ä»æœªè¢«è°ƒç”¨ã€‚

**ä¿®å¤å†…å®¹:**
1. æ·»åŠ  `@click="viewFullReport"` äº‹ä»¶ç»‘å®š
2. å¯¼å…¥ `fetchFullReport` å‡½æ•°
3. æ·»åŠ  `viewFullReport()` æ–¹æ³• â€” è°ƒç”¨ `GET /api/v1/reports/full` + `X-Role: patient`
4. æ·»åŠ åº•éƒ¨å¼¹å‡ºå±‚ (`van-popup position="bottom"`) å±•ç¤ºæŠ¥å‘Š
5. API å¤±è´¥æ—¶ä½¿ç”¨ mock æŠ¥å‘Šæ•°æ®(3ç« : å¥åº·æ¡£æ¡ˆ/è¡Œä¸ºä»»åŠ¡è¿›åº¦/è¶‹åŠ¿ä¸å»ºè®®)
6. æ·»åŠ  loading çŠ¶æ€é˜²æ­¢é‡å¤ç‚¹å‡»

### 12.2 Profile é¡µé¢èœå•é¡¹éœ€å…³æ³¨

**æ–‡ä»¶:** `h5/src/views/Profile.vue`

**ç°çŠ¶:** "å¥åº·æ¡£æ¡ˆ"å’Œ"å†å²æŠ¥å‘Š"èœå•é¡¹ç‚¹å‡»åä»… showToast å ä½ï¼Œæœªè·³è½¬åˆ°å®é™…é¡µé¢ã€‚

**å»ºè®®:**
- "å¥åº·æ¡£æ¡ˆ" â†’ è·³è½¬åˆ° `/` (é¦–é¡µå¥åº·æŒ‡æ ‡åŒºåŸŸ) æˆ–æ–°å»ºæ¡£æ¡ˆé¡µ
- "å†å²æŠ¥å‘Š" â†’ å¯¹æ¥ Dashboard çš„ viewFullReport æˆ–æ–°å»ºæŠ¥å‘Šåˆ—è¡¨é¡µ

### 12.3 h5 Home ç”¨è¯æé†’

**ç°çŠ¶:** ä½¿ç”¨ç¡¬ç¼–ç  mock æ•°æ®(äºŒç”²åŒèƒ/æ ¼åˆ—ç¾è„²/é˜¿å¡æ³¢ç³–)

**å»ºè®®:** å¯¹æ¥åç«¯å¤„æ–¹æ¥å£(å¾…å»ºè®¾)

---

## åä¸‰ã€UI è®¾è®¡ç”ŸæˆæŒ‡å¼•

### è®¾è®¡ä»¤ç‰Œä½“ç³»

| ç³»ç»Ÿ | æ–¹æ¡ˆ |
|------|------|
| h5 | SCSSå˜é‡ (`$primary-color`, `$warning-color`, `$font-size-*`, `$spacing-*`) |
| h5-patient-app | Vant 4 é»˜è®¤ä¸»é¢˜ |
| admin-portal | Ant Design Vue 4 é»˜è®¤ä¸»é¢˜ + constants/index.ts æ˜ å°„è¡¨ |

### å¸ƒå±€è§„èŒƒ

| ç«¯ | å¸ƒå±€ |
|----|------|
| h5 | NavBar(é¡¶) + Content(ä¸­) + TabBar(åº•5é¡¹: é¦–é¡µ/å¯¹è¯/ä»»åŠ¡/çœ‹æ¿/æˆ‘çš„) |
| h5-patient-app | NavBar(é¡¶) + Content(ä¸­), æ— TabBar |
| admin-portal | Sider(220px/æŠ˜å 80px) + Header(é¢åŒ…å±‘+ç”¨æˆ·) + Content |

### é¡µé¢æ¨¡å¼

| ç±»å‹ | ç»“æ„ | å…¸å‹é¡µé¢ |
|------|------|---------|
| åˆ—è¡¨é¡µ | ç»Ÿè®¡å¡ç‰‡ + ç­›é€‰æ  + è¡¨æ ¼ + å¼¹çª—CRUD | æ•™ç»ƒåˆ—è¡¨/é¢˜åº“/è€ƒè¯• |
| è¡¨å•é¡µ | å‚ç›´è¡¨å• + æ ¡éªŒ + æäº¤ | è¯„ä¼°å½•å…¥/Promptç¼–è¾‘ |
| ä»ªè¡¨ç›˜ | Gridç»Ÿè®¡å¡ + å›¾è¡¨ + å¿«æ·æ“ä½œ | Dashboard/å¥åº·çœ‹æ¿ |
| å¯¹è¯é¡µ | æ¶ˆæ¯åˆ—è¡¨ + è¾“å…¥æ¡† + ä¸“å®¶åˆ‡æ¢ | Chat |
| è¯¦æƒ…é¡µ | ä¿¡æ¯å¡ç‰‡ + Tabåˆ‡æ¢ + æ“ä½œæŒ‰é’® | å­¦å‘˜è¯¦æƒ…/æ•™ç»ƒè¯¦æƒ… |

### Mock æ•°æ®ç­–ç•¥

æ‰€æœ‰å‰ç«¯ API å±‚å‡æœ‰ catch fallback è¿”å› mock æ•°æ®ï¼Œç¡®ä¿:
- åç«¯æœªå¯åŠ¨æ—¶ UI å¯ç‹¬ç«‹è¿è¡Œ
- æ–°é¡µé¢å¼€å‘æ—¶å…ˆç”¨ mockï¼Œå†å¯¹æ¥çœŸå® API
- Mock æ•°æ®ç»“æ„å¿…é¡»ä¸çœŸå® API å“åº”ç»“æ„å®Œå…¨ä¸€è‡´
