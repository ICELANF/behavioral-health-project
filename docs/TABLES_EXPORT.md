# 行为健康平台 - 表格汇总与逻辑关系

> 生成时间: 2026-01-26
> 共计: 18张表格

---

## 一、架构层表格 (4张)

### 表1: 八爪鱼架构组件
| 组件 | 英文 | 定义 | 实现 |
|------|------|------|------|
| 大脑 | Brain | AI模型层，理解和生成 | Ollama (qwen2.5:14b, deepseek-r1:7b) |
| 数据池 | Knowledge Pool | 健康知识库，RAG检索源 | Obsidian/向量库 |
| 触手 | Tentacle | 业务主线，面向不同用户群 | 三条主线 |
| 工具 | Tools | 实现平台和框架 | Dify/Vue/FastAPI |

### 表2: 系统层次结构
| 层次 | 职责 | 技术选型 | 状态 |
|------|------|----------|------|
| 用户层 | 界面交互 | Vue3/H5 | 部分完成 |
| AI层 | 智能对话 | Dify+Ollama | ✅完成 |
| 业务层 | 业务逻辑 | FastAPI | 待开发 |
| 数据层 | 数据存储 | PostgreSQL+向量库 | ✅完成 |

### 表3: 工具平台清单
| 工具 | 用途 | 地址 |
|------|------|------|
| Dify | AI应用编排 | http://localhost:8080 |
| Ollama | 本地大模型 | http://localhost:11434 |
| Obsidian | 知识管理 | 本地 |
| Vue3 | 前端框架 | - |
| FastAPI | 后端框架 | - |
| PostgreSQL | 关系数据库 | localhost:5432 |
| Weaviate | 向量数据库 | localhost:8080 |

### 表4: Docker服务清单
| 服务 | 镜像 | 端口 | 用途 |
|------|------|------|------|
| dify-api | langgenius/dify-api:0.15.3 | 5001 | API服务 |
| dify-worker | langgenius/dify-api:0.15.3 | - | 后台任务 |
| dify-web | langgenius/dify-web:0.15.3 | 3000 | Web前端 |
| dify-nginx | nginx:latest | 8080 | 反向代理 |
| dify-db | postgres:15-alpine | 5432 | 数据库 |
| dify-redis | redis:7-alpine | 6379 | 缓存 |
| dify-weaviate | semitechnologies/weaviate | 8080 | 向量库 |
| dify-sandbox | langgenius/dify-sandbox | 8194 | 代码沙箱 |

---

## 二、业务主线表格 (6张)

### 表5: 三条业务主线定义
| 主线 | 代号 | 服务对象 | 核心价值 | 实现载体 |
|------|------|----------|----------|----------|
| 专家Chatflow | 触手1 | 专家 | 知识变现 | Dify Agent |
| 用户行为养成 | 触手2 | 患者/用户 | 健康改善 | H5应用 |
| 教练培养体系 | 触手3 | 健康教练 | 能力认证 | Admin Portal |

### 表6: 触手1-专家Chatflow分层
| 层次 | 代号 | 内容 | 状态 | 关键产出 |
|------|------|------|------|----------|
| 呈现层 | L4 | Dify对话界面/API | ✅ | 对话入口 |
| 应用层 | L3 | 专家Chatflow配置 | ✅ | 吃动守恒专家 |
| 能力层 | L2 | Prompt模板/工具调用 | ✅ | system prompt |
| 知识层 | L1 | 专家知识库(RAG) | 🔨 | Obsidian文档 |
| 模型层 | L0 | qwen2.5:14b | ✅ | 大脑 |

### 表7: 触手2-用户行为养成分层
| 层次 | 代号 | 内容 | 状态 | 关键产出 |
|------|------|------|------|----------|
| 呈现层 | L4 | H5/小程序 | ⏳ | 用户界面 |
| 应用层 | L3 | 行为干预流程 | ⏳ | 干预方案 |
| 能力层 | L2 | TTM评估/目标设定 | ⏳ | 评估问卷 |
| 数据层 | L1 | 用户健康档案 | ⏳ | 数据结构 |
| 模型层 | L0 | AI教练对话 | ✅ | 复用大脑 |

### 表8: 触手3-教练培养体系分层
| 层次 | 代号 | 内容 | 状态 | 关键产出 |
|------|------|------|------|----------|
| 呈现层 | L4 | 管理后台Admin Portal | ✅ | Vue前端 |
| 应用层 | L3 | 培训认证流程 | 🔨 | 课程/考试 |
| 能力层 | L2 | 等级体系/考核标准 | 🔨 | L0-L4定义 |
| 数据层 | L1 | 教练/学员档案 | 🔨 | 数据结构 |
| 支撑层 | L0 | 后端API | ⏳ | FastAPI |

### 表9: 教练等级体系
| 等级 | 名称 | 要求 | 权限 |
|------|------|------|------|
| L0 | 学员 | 注册 | 学习课程 |
| L1 | 初级教练 | 通过L1考试 | 带5名学员 |
| L2 | 中级教练 | 通过L2考试+案例 | 带20名学员 |
| L3 | 高级教练 | 通过L3考试+督导 | 带50名学员+带教练 |
| L4 | 督导专家 | 专家认证 | 督导+课程开发 |

### 表10: 用户行为阶段(TTM模型)
| 阶段 | 英文 | 特征 | 干预策略 |
|------|------|------|----------|
| 前意向期 | Precontemplation | 无改变意愿 | 提升认知，不施压 |
| 意向期 | Contemplation | 考虑改变 | 利弊分析，增强信心 |
| 准备期 | Preparation | 准备行动 | 设定目标，制定计划 |
| 行动期 | Action | 正在改变 | 持续支持，监测进度 |
| 维持期 | Maintenance | 维持习惯 | 预防复发，强化成就 |

---

## 三、关键词表格 (3张)

### 表11: 架构层关键词
| 关键词 | 英文 | 定义 | 归属 |
|--------|------|------|------|
| 大脑 | Brain | AI模型层 | Ollama |
| 数据池 | Knowledge Pool | 知识库 | Obsidian |
| 触手 | Tentacle | 业务主线 | 三条主线 |
| 工具 | Tools | 平台框架 | Dify/Vue |

### 表12: 业务层关键词
| 关键词 | 定义 | 所属触手 |
|--------|------|----------|
| 专家 | 提供专业知识的个体 | 触手1 |
| Chatflow | 专家的AI对话流程 | 触手1 |
| 用户/患者 | 终端使用者 | 触手2 |
| 行为养成 | TTM习惯培养 | 触手2 |
| 教练 | 认证健康指导者 | 触手3 |
| 学员 | 教练管理的用户 | 触手3 |
| 督导 | 监督教练的高级角色 | 触手3 |

### 表13: 理论模型关键词
| 关键词 | 全称 | 定义 |
|--------|------|------|
| TTM | 跨理论模型 | 行为改变5阶段 |
| MI | 动机访谈 | 引导内在动机 |
| SMART | 目标设定法 | 具体可衡量目标 |

---

## 四、状态管理表格 (3张)

### 表14: 模块完成状态
| 模块 | 所属 | 状态 | 冻结 |
|------|------|------|------|
| Dify平台配置 | 工具层 | ✅完成 | 🔒是 |
| 吃动守恒专家 | 触手1 | ✅完成 | 🔒是 |
| docker-compose | 工具层 | ✅完成 | 🔒是 |
| 登录模块 | 触手3 | ✅完成 | 🔒是 |
| 课程管理 | 触手3 | ✅完成 | 否 |
| 考试系统 | 触手3 | ✅完成 | 否 |
| 题库管理 | 触手3 | ✅完成 | 否 |
| 教练管理 | 触手3 | 🔨进行中 | 否 |
| 用户H5 | 触手2 | ⏳待开发 | 否 |

### 表15: 变更控制规则
| 类型 | 处理方式 | 审批 |
|------|----------|------|
| 新增功能 | 新建文件，不改已有 | 无需 |
| Bug修复 | 最小改动，记录变更 | 无需 |
| 重构优化 | 需评估影响范围 | 需确认 |
| 冻结模块修改 | 原则上禁止 | 需明确提出 |

### 表16: Ollama模型清单
| 模型 | 大小 | 用途 | 状态 |
|------|------|------|------|
| qwen2.5:14b | 9.0GB | 主模型-对话 | ✅可用 |
| deepseek-r1:7b | 4.7GB | 备选模型 | ✅可用 |
| nomic-embed-text | 274MB | 向量嵌入 | ✅可用 |

---

## 五、配置文件表格 (2张)

### 表17: 项目文件结构
| 路径 | 类型 | 用途 | 冻结 |
|------|------|------|------|
| /dify-setup/ | 目录 | Dify配置 | 🔒是 |
| /admin-portal/ | 目录 | 管理后台 | 部分 |
| /h5/ | 目录 | 用户端H5 | 否 |
| /docs/ | 目录 | 文档 | 否 |
| /docker-compose.yaml | 文件 | Docker编排 | 🔒是 |
| /architecture.yaml | 文件 | 架构定义 | 🔒是 |
| /start.bat | 文件 | 启动脚本 | 否 |

### 表18: 环境变量配置
| 变量 | 默认值 | 用途 |
|------|--------|------|
| DIFY_API_URL | http://localhost:8080 | Dify地址 |
| DIFY_API_KEY | app-TSdoLNkz636aipfD9zTtHdEY | API密钥 |
| OLLAMA_BASE_URL | http://localhost:11434 | Ollama地址 |
| OLLAMA_MODEL | qwen2.5:14b | 默认模型 |
| DB_PASSWORD | difyai123456 | 数据库密码 |
| REDIS_PASSWORD | difyai123456 | Redis密码 |

---

## 六、表格逻辑关系

详见下方关系图。
