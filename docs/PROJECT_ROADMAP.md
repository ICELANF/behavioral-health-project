# è¡Œä¸ºå¥åº·å¹³å° - é¡¹ç›®è¿›åº¦å›é¡¾ä¸è·¯çº¿å›¾

> æ›´æ–°æ—¥æœŸï¼š2026-01-28
> çŠ¶æ€ï¼šå¼€å‘ä¸­ - æ ¸å¿ƒæ¨¡å—åŸºæœ¬å®Œæˆï¼ŒCLIé›†æˆå¾…å®Œå–„

---

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®å®šä½

**è¡Œä¸ºå¥åº·å¤šæ¨¡æ€AIé™ªä¼´ä¸æŒ‡å¯¼å¹³å°**
- é¢å‘Cç«¯ç”¨æˆ·çš„å¥åº·ç®¡ç†åº”ç”¨
- åŸºäº"Octopus Architecture"å¤šAgentååŒæ¶æ„
- é›†æˆæœ¬åœ°LLMï¼ˆOllamaï¼‰+ äº‘ç«¯AIï¼ˆDifyï¼‰
- æ•°æ®é©±åŠ¨çš„ä¸ªæ€§åŒ–å¥åº·å¹²é¢„

### 1.2 å½“å‰é˜¶æ®µ

**é˜¶æ®µ2ï¼šæ ¸å¿ƒå¼•æ“å¼€å‘ï¼ˆ70%å®Œæˆï¼‰**
- âœ… L2è¯„ä¼°åˆ†æµå¼•æ“ï¼ˆç³»ç»Ÿå¤§è„‘ï¼‰å·²å®Œæˆ
- âœ… å¤šæ¨¡æ€æ•°æ®å¤„ç†å·²å®Œæˆ
- âœ… Multi-AgentååŒæ¡†æ¶å·²å®Œæˆ
- âœ… APIåç«¯åŸºç¡€å·²å®Œæˆ
- âš ï¸ CLIå…¥å£ç¼ºå¤±
- âŒ ç”¨æˆ·ç•Œé¢ä¸å®Œæ•´
- âŒ æ•°æ®é‡‡é›†ç³»ç»Ÿç¼ºå¤±

---

## äºŒã€å·²å®Œæˆæ¨¡å—æ¸…å•

### 2.1 æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼ˆâœ… å®Œæˆåº¦ï¼š85%ï¼‰

| æ¨¡å— | æ–‡ä»¶ | è¡Œæ•° | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|------|------|
| **Master Agent** | `core/master_agent.py` | 6,801 | âœ… | 9æ­¥éª¤ç¼–æ’æµç¨‹å®Œæ•´ |
| **L2è¯„ä¼°å¼•æ“** | `core/assessment_engine.py` | 524 | âœ… | 4æ¨¡å—ï¼ˆè¯†åˆ«â†’è¯„ä¼°â†’è·¯ç”±â†’å¹²é¢„ï¼‰ |
| **Triggerå¼•æ“** | `core/trigger_engine.py` | 604 | âœ… | 28ä¸ªæ ‡ç­¾ï¼Œ4å¤§ç±»åˆ« |
| **å¤šæ¨¡æ€å®¢æˆ·ç«¯** | `core/multimodal_client.py` | 325 | âœ… | æ–‡æœ¬+ä¿¡å·+èåˆå¤„ç† |
| **æ•°æ®ç®¡é“** | `core/pipeline.py` | 1,091 | âœ… | å·¥ä½œæµæ‰§è¡Œ |
| **æ¨¡å‹ç®¡ç†** | `core/model_manager.py` | 368 | âœ… | LLMæ¨¡å‹ç®¡ç† |

**æ€»è®¡ï¼š10,901 è¡Œæ ¸å¿ƒä»£ç **

### 2.2 Multi-Agentç³»ç»Ÿï¼ˆâœ… å®Œæˆåº¦ï¼š90%ï¼‰

| æ¨¡å— | æ–‡ä»¶ | è¡Œæ•° | çŠ¶æ€ |
|------|------|------|------|
| **ç¼–æ’å™¨** | `agents/orchestrator.py` | 262 | âœ… |
| **è·¯ç”±å™¨** | `agents/router.py` | 230 | âœ… |
| **ååŒåè®®** | `agents/collaboration.py` | 230 | âœ… |
| **Agentå·¥å‚** | `agents/factory.py` | 206 | âœ… |
| **æ³¨å†Œä¸­å¿ƒ** | `agents/registry.py` | 128 | âœ… |
| **Octopuså¼•æ“** | `agents/octopus_engine.py` | 248 | âœ… |

**æ€»è®¡ï¼š1,893 è¡ŒAgentç³»ç»Ÿä»£ç **

### 2.3 APIåç«¯ï¼ˆâœ… å®Œæˆåº¦ï¼š80%ï¼‰

| æ¨¡å— | ç«¯ç‚¹æ•° | çŠ¶æ€ |
|------|--------|------|
| **ä¸»API** | `api/main.py` | 20+ | âœ… |
| **ç¼–æ’å™¨API** | POST /orchestrator/process | âœ… |
| **BAPS API** | POST /baps/assessment | âœ… |
| **ä¼šè¯ç®¡ç†** | POST /session/create | âœ… |
| **çŸ¥è¡Œå»ºAPI** | POST /xingjian/chat | âœ… |

**æ€»è®¡ï¼š2,448 è¡ŒAPIä»£ç **

### 2.4 çŸ¥è¯†ç³»ç»Ÿï¼ˆâœ… å®Œæˆåº¦ï¼š70%ï¼‰

```
knowledge/
â”œâ”€â”€ triggers/              # âœ… Triggerå­—å…¸ï¼ˆ28ä¸ªæ ‡ç­¾ï¼‰
â”‚   â”œâ”€â”€ trigger-tags-v1.json
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ kb_theory/             # âœ… ç†è®ºæ¡†æ¶çŸ¥è¯†åº“
â”œâ”€â”€ kb_case_studies/       # âœ… æ¡ˆä¾‹ç ”ç©¶
â”œâ”€â”€ kb_products/           # âœ… äº§å“çŸ¥è¯†
â””â”€â”€ data/
    â”œâ”€â”€ profiles/          # âš ï¸ ç”¨æˆ·ç”»åƒï¼ˆç»“æ„å¾…å®Œå–„ï¼‰
    â”œâ”€â”€ assessments/       # âš ï¸ è¯„ä¼°æ•°æ®
    â””â”€â”€ vectordb/          # âœ… å‘é‡æ•°æ®åº“
```

### 2.5 æµ‹è¯•è¦†ç›–ï¼ˆâœ… å®Œæˆåº¦ï¼š75%ï¼‰

| æµ‹è¯•æ–‡ä»¶ | åœºæ™¯æ•° | çŠ¶æ€ |
|----------|--------|------|
| `test_end_to_end.py` | 6ä¸ªåœºæ™¯ | âœ… å…¨éƒ¨é€šè¿‡ |
| `test_multimodal_integration.py` | 5ä¸ªæµ‹è¯• | âœ… å…¨éƒ¨é€šè¿‡ |
| `integration_test.py` | é›†æˆæµ‹è¯• | âœ… |

**æ€§èƒ½æŒ‡æ ‡ï¼šå¹³å‡å“åº”æ—¶é—´ 9.31msï¼ˆç›®æ ‡<100msï¼‰âœ…**

### 2.6 æ–‡æ¡£ç³»ç»Ÿï¼ˆâœ… å®Œæˆåº¦ï¼š90%ï¼‰

| æ–‡æ¡£ | çŠ¶æ€ |
|------|------|
| `PROJECT_OVERVIEW_EXECUTIVE.md` | âœ… å®Œæ•´ |
| `GAP_ANALYSIS_BLUEPRINT.md` | âœ… å®Œæ•´ |
| `L2_ASSESSMENT_ENGINE.md` | âœ… å®Œæ•´ |
| `CORE_DATA_SCHEMA_v1_SPECIFICATION.md` | âœ… å®Œæ•´ |
| `DEPLOYMENT_ARCHITECTURE.md` | âœ… å®Œæ•´ |
| **ç¼ºå¤±ï¼šGetting StartedæŒ‡å—** | âŒ |

### 2.7 åŸºç¡€è®¾æ–½ï¼ˆâœ… å®Œæˆåº¦ï¼š90%ï¼‰

| ç»„ä»¶ | çŠ¶æ€ | ç«¯å£ |
|------|------|------|
| **Docker Compose** | âœ… é…ç½®å®Œæ•´ | - |
| **Dify Platform** | âœ… é›†æˆ | 8080 |
| **Ollama** | âœ… é›†æˆ | 11434 |
| **PostgreSQL** | âœ… é…ç½® | 5432 |
| **Redis** | âœ… é…ç½® | 6379 |
| **Weaviate** | âœ… é…ç½® | 8080 |

---

## ä¸‰ã€å…³é”®ç¼ºå¤±é¡¹ï¼ˆé˜»ç¢ç»ˆç«¯ç›´æ¥è¿è¡Œï¼‰

### ğŸ”´ P0 - é˜»å¡æ€§ç¼ºå¤±ï¼ˆå¿…é¡»å®Œæˆï¼‰

#### 3.1 æ— ç»Ÿä¸€CLIå…¥å£ âŒ

**å½“å‰çŠ¶æ€ï¼š**
- åªèƒ½é€šè¿‡ `python api/main.py` å¯åŠ¨APIæœåŠ¡å™¨
- æ—  `__main__.py` æˆ– `cli.py`
- æ— å‘½ä»¤è¡Œå‚æ•°è§£æ
- æ—  `python -m behavioral_health` èƒ½åŠ›

**å½±å“ï¼š**
- ç”¨æˆ·æ— æ³•"ç»ˆç«¯ç›´æ¥è¿è¡Œ"
- æ— ç»Ÿä¸€å¯åŠ¨å‘½ä»¤
- å¼€å‘ä½“éªŒå·®

#### 3.2 ç¼ºå¤±ä¾èµ–ç®¡ç† âŒ

**å½“å‰çŠ¶æ€ï¼š**
- âŒ æ—  `requirements.txt`ï¼ˆæ ¹ç›®å½•ï¼‰
- âŒ æ—  `setup.py` / `pyproject.toml`
- âŒ æ— æ³•æ‰§è¡Œ `pip install -e .`
- âœ… è™šæ‹Ÿç¯å¢ƒå­˜åœ¨ï¼ˆ.venv/ï¼‰ä½†ä¾èµ–æœªå¯¼å‡º

**å½±å“ï¼š**
- æ–°ç¯å¢ƒæ— æ³•å¿«é€Ÿéƒ¨ç½²
- ä¾èµ–ç‰ˆæœ¬ä¸æ˜ç¡®
- åŒ…æ— æ³•åˆ†å‘å®‰è£…

#### 3.3 æ•°æ®åº“æœªåˆå§‹åŒ– âŒ

**å½“å‰çŠ¶æ€ï¼š**
- âœ… PostgreSQLé…ç½®å­˜åœ¨ï¼ˆ.envï¼‰
- âŒ æ— æ•°æ®åº“Schemaå®šä¹‰
- âŒ æ— è¿ç§»è„šæœ¬ï¼ˆAlembicï¼‰
- âŒ æ— åˆå§‹åŒ–å‘½ä»¤
- âŒ æ— ç§å­æ•°æ®

**å½±å“ï¼š**
- é¦–æ¬¡è¿è¡Œå¿…å®šæŠ¥é”™
- æ— æ³•æŒä¹…åŒ–æ•°æ®
- æ— æ³•è¿›è¡Œå®é™…æµ‹è¯•

#### 3.4 ç”¨æˆ·æ³¨å†Œ/ç™»å½•ç¼ºå¤± âŒ

**å½“å‰çŠ¶æ€ï¼š**
- âš ï¸ Sessionç®¡ç†å­˜åœ¨ï¼ˆ`api/session.py`ï¼‰
- âŒ æ— æ³¨å†Œç«¯ç‚¹
- âŒ æ— ç™»å½•ç«¯ç‚¹
- âŒ æ— JWT/Tokenæœºåˆ¶
- âŒ æ— RBACæƒé™æ§åˆ¶

**å½±å“ï¼š**
- æ— æ³•åˆ›å»ºæµ‹è¯•ç”¨æˆ·
- æ— æ³•ä¿æŠ¤APIç«¯ç‚¹
- å®‰å…¨æ€§ç¼ºå¤±

### ğŸŸ¡ P1 - é‡è¦ç¼ºå¤±ï¼ˆå½±å“ç”¨æˆ·ä½“éªŒï¼‰

#### 3.5 æ‚£è€…ç«¯ç•Œé¢ç¼ºå¤± âŒ

**å½“å‰çŠ¶æ€ï¼š**
- âœ… Admin Portalå­˜åœ¨ï¼ˆVue3 + TypeScriptï¼‰
- âŒ æ‚£è€…H5åº”ç”¨ç¼ºå¤±
- âŒ é—®å·/è¯„ä¼°è¡¨å•ç¼ºå¤±
- âŒ æ•°æ®å½•å…¥ç•Œé¢ç¼ºå¤±

**å½±å“ï¼š**
- æ— æ³•é‡‡é›†ç”¨æˆ·æ•°æ®
- æ— æ³•è¿›è¡Œç«¯åˆ°ç«¯æ¼”ç¤º
- L2è¯„ä¼°å¼•æ“æ— æ•°æ®æº

#### 3.6 æ•°æ®é‡‡é›†ç®¡é“ç¼ºå¤± âŒ

**å½“å‰çŠ¶æ€ï¼š**
- âœ… æ•°æ®å¤„ç†å¼•æ“å­˜åœ¨
- âŒ æ— ç”¨æˆ·è¾“å…¥æ¥å£
- âŒ æ— å¯ç©¿æˆ´è®¾å¤‡é›†æˆ
- âŒ æ— æ•°æ®éªŒè¯/è§„èŒƒåŒ–

**å½±å“ï¼š**
- è¯„ä¼°å¼•æ“æ— æ³•è·å–çœŸå®æ•°æ®
- ä¾èµ–Mockæ•°æ®æµ‹è¯•
- æ— æ³•è¿›è¡Œå®é™…åº”ç”¨

### ğŸŸ¢ P2 - ä¼˜åŒ–é¡¹ï¼ˆé•¿æœŸæ”¹è¿›ï¼‰

- âŒ CI/CDæµæ°´çº¿
- âŒ æ—¥å¿—/ç›‘æ§ç³»ç»Ÿ
- âŒ APIæ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆï¼ˆSwaggerï¼‰
- âŒ æ€§èƒ½åˆ†æå·¥å…·
- âŒ å¤šç¯å¢ƒé…ç½®ï¼ˆdev/staging/prodï¼‰

---

## å››ã€ä¸‹ä¸€æ­¥å·¥ä½œè§„åˆ’

### Phase 1ï¼šCLIåŸºç¡€ï¼ˆæœ¬å‘¨å®Œæˆï¼‰- å®ç°"ç»ˆç«¯ç›´æ¥è¿è¡Œ"

#### Task 1.1ï¼šåˆ›å»ºç»Ÿä¸€å…¥å£ç‚¹ ğŸ¯

**æ–‡ä»¶æ¸…å•ï¼š**
```
behavioral-health-project/
â”œâ”€â”€ __main__.py          # CLIä¸»å…¥å£
â”œâ”€â”€ cli.py               # å‘½ä»¤è¡Œé€»è¾‘
â”œâ”€â”€ requirements.txt     # ä¾èµ–åˆ—è¡¨
â””â”€â”€ setup.py             # å®‰è£…é…ç½®
```

**åŠŸèƒ½éœ€æ±‚ï¼š**
```bash
# åŸºç¡€å‘½ä»¤
python -m behavioral_health --help
python -m behavioral_health init         # åˆå§‹åŒ–ç³»ç»Ÿ
python -m behavioral_health serve        # å¯åŠ¨æœåŠ¡
python -m behavioral_health test         # è¿è¡Œæµ‹è¯•
python -m behavioral_health status       # ç³»ç»ŸçŠ¶æ€

# é«˜çº§å‘½ä»¤
python -m behavioral_health db init      # åˆå§‹åŒ–æ•°æ®åº“
python -m behavioral_health db seed      # åŠ è½½ç§å­æ•°æ®
python -m behavioral_health user create  # åˆ›å»ºç”¨æˆ·
```

**æŠ€æœ¯é€‰å‹ï¼š**
- Click / Typerï¼ˆå‘½ä»¤è¡Œæ¡†æ¶ï¼‰
- Richï¼ˆç»ˆç«¯ç¾åŒ–è¾“å‡ºï¼‰
- python-dotenvï¼ˆç¯å¢ƒå˜é‡ç®¡ç†ï¼‰

#### Task 1.2ï¼šç”Ÿæˆä¾èµ–æ–‡ä»¶ ğŸ¯

**æ­¥éª¤ï¼š**
```bash
# 1. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
.venv\Scripts\activate

# 2. å¯¼å‡ºä¾èµ–
pip freeze > requirements.txt

# 3. æ¸…ç†æ— å…³ä¾èµ–
# æ‰‹åŠ¨ç¼–è¾‘ï¼Œåªä¿ç•™ç›´æ¥ä¾èµ–

# 4. åˆ›å»ºå¼€å‘ä¾èµ–
pip freeze > requirements-dev.txt
```

**é¢„æœŸå†…å®¹ï¼š**
```txt
# requirements.txt
fastapi>=0.109.0
pydantic>=2.5.0
uvicorn[standard]>=0.27.0
httpx>=0.26.0
aiohttp>=3.9.0
sqlalchemy>=2.0.25
loguru>=0.7.2
python-dotenv>=1.0.0
click>=8.1.7
rich>=13.7.0

# requirements-dev.txt
pytest>=7.4.3
pytest-asyncio>=0.23.3
black>=23.12.1
ruff>=0.1.9
```

#### Task 1.3ï¼šåˆ›å»ºsetup.py ğŸ¯

**å†…å®¹ï¼š**
```python
from setuptools import setup, find_packages

setup(
    name="behavioral-health",
    version="0.1.0",
    packages=find_packages(),
    include_package_data=True,
    install_requires=[
        "fastapi>=0.109.0",
        "click>=8.1.7",
        # ... å…¶ä»–ä¾èµ–
    ],
    entry_points={
        "console_scripts": [
            "bh=cli:main",  # çŸ­å‘½ä»¤
            "behavioral-health=cli:main",
        ],
    },
    python_requires=">=3.10",
)
```

**å®‰è£…æ–¹å¼ï¼š**
```bash
pip install -e .  # å¼€å‘æ¨¡å¼
bh --help         # ä½¿ç”¨çŸ­å‘½ä»¤
```

#### Task 1.4ï¼šæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ ğŸ¯

**æ–‡ä»¶ï¼š** `scripts/init_db.py`

**åŠŸèƒ½ï¼š**
1. è¯»å–ç¯å¢ƒå˜é‡ï¼ˆDATABASE_URLï¼‰
2. åˆ›å»ºæ•°æ®åº“è¡¨ï¼ˆåŸºäºSQLAlchemyæ¨¡å‹ï¼‰
3. åŠ è½½åˆå§‹æ•°æ®ï¼ˆç®¡ç†å‘˜ç”¨æˆ·ã€é»˜è®¤é…ç½®ï¼‰
4. éªŒè¯è¿æ¥

**å‘½ä»¤ï¼š**
```bash
python -m behavioral_health db init
```

---

### Phase 2ï¼šæ ¸å¿ƒç”¨æˆ·æµç¨‹ï¼ˆ2å‘¨å®Œæˆï¼‰

#### Task 2.1ï¼šç”¨æˆ·è®¤è¯ç³»ç»Ÿ ğŸ”

**ç«¯ç‚¹ï¼š**
- `POST /auth/register` - æ³¨å†Œ
- `POST /auth/login` - ç™»å½•
- `POST /auth/logout` - ç™»å‡º
- `GET /auth/me` - è·å–å½“å‰ç”¨æˆ·

**æŠ€æœ¯ï¼š**
- JWTï¼ˆpython-joseï¼‰
- å¯†ç å“ˆå¸Œï¼ˆpasslib + bcryptï¼‰
- ä¸­é—´ä»¶ä¿æŠ¤

#### Task 2.2ï¼šæœ€å°åŒ–æ‚£è€…H5ç•Œé¢ ğŸ“±

**é¡µé¢ï¼š**
1. **ç™»å½•/æ³¨å†Œé¡µ**
2. **ä¸»é¡µ/ä»ªè¡¨ç›˜** - å±•ç¤ºä»Šæ—¥æ•°æ®
3. **æ•°æ®å½•å…¥é¡µ** - æ–‡å­—æ¶ˆæ¯ã€è¡€ç³–ã€HRV
4. **è¯„ä¼°ç»“æœé¡µ** - æ˜¾ç¤ºé£é™©ç­‰çº§å’Œå»ºè®®

**æŠ€æœ¯æ ˆï¼š**
- Vue 3 + TypeScript
- Vant UIï¼ˆç§»åŠ¨ç«¯ç»„ä»¶åº“ï¼‰
- Axiosï¼ˆAPIè°ƒç”¨ï¼‰

**APIå¯¹æ¥ï¼š**
```javascript
// æäº¤è¯„ä¼°
POST /api/assessment/submit
{
  text: "ä»Šå¤©å‹åŠ›å¾ˆå¤§...",
  glucose: [6.5, 11.2],
  hrv: [65, 68]
}

// è·å–ç»“æœ
GET /api/assessment/{assessment_id}
```

#### Task 2.3ï¼šç«¯åˆ°ç«¯æ¼”ç¤ºæµç¨‹ ğŸ¬

**å®Œæ•´æµç¨‹ï¼š**
```
1. ç”¨æˆ·æ³¨å†Œ/ç™»å½•
   â†“
2. H5é¡µé¢è¾“å…¥æ•°æ®ï¼ˆæ–‡æœ¬ + ç”Ÿç†æŒ‡æ ‡ï¼‰
   â†“
3. POST /assessment/submit
   â†“
4. L2è¯„ä¼°å¼•æ“å¤„ç†
   â”œâ”€ Triggerè¯†åˆ«
   â”œâ”€ é£é™©è¯„ä¼°
   â”œâ”€ Agentè·¯ç”±
   â””â”€ ç”Ÿæˆå¹²é¢„å»ºè®®
   â†“
5. è¿”å›ç»“æœåˆ°H5é¡µé¢
   â†“
6. å±•ç¤ºé£é™©ç­‰çº§ã€å»ºè®®è¡ŒåŠ¨ã€ä¸‹ä¸€æ­¥
```

---

### Phase 3ï¼šæ•°æ®ç³»ç»Ÿå®Œå–„ï¼ˆ3å‘¨å®Œæˆï¼‰

#### Task 3.1ï¼šæ•°æ®Schemaå®šä¹‰

**æ–‡ä»¶ï¼š** `core/models.py`

**æ ¸å¿ƒè¡¨ï¼š**
```python
class User(Base):
    id: int
    username: str
    email: str
    created_at: datetime

class Assessment(Base):
    id: int
    user_id: int
    text_content: str
    glucose_values: JSON
    hrv_values: JSON
    risk_level: str
    routing_decision: JSON
    created_at: datetime

class Trigger(Base):
    id: int
    assessment_id: int
    tag_id: str
    severity: str
    confidence: float

class Intervention(Base):
    id: int
    assessment_id: int
    agent_type: str
    actions: JSON
```

#### Task 3.2ï¼šæ•°æ®é‡‡é›†API

**ç«¯ç‚¹ï¼š**
- `POST /data/glucose` - è¡€ç³–æ•°æ®
- `POST /data/hrv` - HRVæ•°æ®
- `POST /data/activity` - æ´»åŠ¨æ•°æ®
- `POST /data/sleep` - ç¡çœ æ•°æ®
- `GET /data/history` - å†å²æ•°æ®

#### Task 3.3ï¼šè®¾å¤‡é›†æˆï¼ˆå¯é€‰ï¼‰

**æ”¯æŒçš„è®¾å¤‡ï¼š**
- CGMï¼ˆè¿ç»­è¡€ç³–ç›‘æµ‹ï¼‰
- æ™ºèƒ½æ‰‹ç¯ï¼ˆHRVï¼‰
- Apple Health / Google Fit

**é›†æˆæ–¹å¼ï¼š**
- OAuth2è®¤è¯
- Webhookå›è°ƒ
- å®šæ—¶æ‹‰å–

---

### Phase 4ï¼šéƒ¨ç½²ä¼˜åŒ–ï¼ˆ1å‘¨å®Œæˆï¼‰

#### Task 4.1ï¼šDockeråŒ–

**æ–‡ä»¶ï¼š** `Dockerfile`

```dockerfile
FROM python:3.10-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .
RUN pip install -e .

EXPOSE 8000
CMD ["python", "-m", "behavioral_health", "serve"]
```

#### Task 4.2ï¼šç¯å¢ƒé…ç½®ç®¡ç†

**æ–‡ä»¶ï¼š** `config/`
```
config/
â”œâ”€â”€ dev.yaml       # å¼€å‘ç¯å¢ƒ
â”œâ”€â”€ staging.yaml   # é¢„å‘å¸ƒ
â””â”€â”€ prod.yaml      # ç”Ÿäº§ç¯å¢ƒ
```

**ä½¿ç”¨ï¼š**
```bash
BH_ENV=dev python -m behavioral_health serve
```

#### Task 4.3ï¼šå¥åº·æ£€æŸ¥

**ç«¯ç‚¹ï¼š**
- `GET /health` - ç³»ç»Ÿå¥åº·
- `GET /health/db` - æ•°æ®åº“è¿æ¥
- `GET /health/llm` - LLMæœåŠ¡çŠ¶æ€
- `GET /health/dify` - Difyå¹³å°çŠ¶æ€

---

## äº”ã€å¿«é€Ÿå¯åŠ¨æŒ‡å—ï¼ˆç›®æ ‡çŠ¶æ€ï¼‰

### 5.1 é¦–æ¬¡å®‰è£…

```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/your-org/behavioral-health-project.git
cd behavioral-health-project

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv .venv
.venv\Scripts\activate

# 3. å®‰è£…ä¾èµ–
pip install -e .

# 4. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env é…ç½®æ•°æ®åº“ã€LLMç­‰

# 5. åˆå§‹åŒ–ç³»ç»Ÿ
python -m behavioral_health init

# 6. å¯åŠ¨æœåŠ¡
python -m behavioral_health serve
```

### 5.2 æ—¥å¸¸å¼€å‘

```bash
# æ¿€æ´»ç¯å¢ƒ
.venv\Scripts\activate

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆçƒ­é‡è½½ï¼‰
python -m behavioral_health serve --reload

# è¿è¡Œæµ‹è¯•
python -m behavioral_health test

# æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
python -m behavioral_health status
```

### 5.3 ç”Ÿäº§éƒ¨ç½²

```bash
# ä½¿ç”¨Docker
docker-compose up -d

# æˆ–ä½¿ç”¨CLI
BH_ENV=prod python -m behavioral_health serve --workers 4
```

---

## å…­ã€æŠ€æœ¯å€ºåŠ¡æ¸…å•

### 6.1 ä»£ç è´¨é‡

- [ ] æ·»åŠ ç±»å‹æ³¨è§£ï¼ˆmypyæ£€æŸ¥ï¼‰
- [ ] ç»Ÿä¸€ä»£ç é£æ ¼ï¼ˆblack + ruffï¼‰
- [ ] å¢åŠ å•å…ƒæµ‹è¯•è¦†ç›–ç‡ï¼ˆç›®æ ‡80%ï¼‰
- [ ] æ·»åŠ ä»£ç æ³¨é‡Šå’Œdocstring

### 6.2 æ€§èƒ½ä¼˜åŒ–

- [ ] æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–ï¼ˆç´¢å¼•ã€è¿æ¥æ± ï¼‰
- [ ] APIå“åº”ç¼“å­˜ï¼ˆRedisï¼‰
- [ ] å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ï¼ˆCeleryï¼‰
- [ ] LLMæ¨ç†ä¼˜åŒ–ï¼ˆæ‰¹å¤„ç†ã€æµå¼è¾“å‡ºï¼‰

### 6.3 å®‰å…¨åŠ å›º

- [ ] APIé€Ÿç‡é™åˆ¶
- [ ] è¾“å…¥éªŒè¯å’Œæ¸…æ´—
- [ ] SQLæ³¨å…¥é˜²æŠ¤
- [ ] XSS/CSRFä¿æŠ¤
- [ ] æ•æ„Ÿæ•°æ®åŠ å¯†

### 6.4 ç›‘æ§ä¸æ—¥å¿—

- [ ] ç»“æ„åŒ–æ—¥å¿—ï¼ˆJSONæ ¼å¼ï¼‰
- [ ] æ—¥å¿—èšåˆï¼ˆELK/Lokiï¼‰
- [ ] æ€§èƒ½æŒ‡æ ‡ï¼ˆPrometheusï¼‰
- [ ] é”™è¯¯è¿½è¸ªï¼ˆSentryï¼‰
- [ ] ç”¨æˆ·è¡Œä¸ºåˆ†æ

---

## ä¸ƒã€èµ„æºä¼°ç®—

### 7.1 å¼€å‘å·¥æ—¶

| Phase | ä»»åŠ¡æ•° | é¢„è®¡å·¥æ—¶ | äººå‘˜ |
|-------|--------|----------|------|
| Phase 1 | 4ä¸ª | 20å°æ—¶ | 1ååç«¯ |
| Phase 2 | 3ä¸ª | 80å°æ—¶ | 1ååç«¯ + 1åå‰ç«¯ |
| Phase 3 | 3ä¸ª | 60å°æ—¶ | 1ååç«¯ |
| Phase 4 | 3ä¸ª | 20å°æ—¶ | 1åDevOps |
| **æ€»è®¡** | **13ä¸ª** | **180å°æ—¶** | **~1.5æœˆ** |

### 7.2 åŸºç¡€è®¾æ–½éœ€æ±‚

**å¼€å‘ç¯å¢ƒï¼š**
- CPU: 4æ ¸
- å†…å­˜: 8GB
- å­˜å‚¨: 50GB

**ç”Ÿäº§ç¯å¢ƒï¼ˆé¢„ä¼°ï¼‰ï¼š**
- åº”ç”¨æœåŠ¡å™¨ï¼š2å°ï¼ˆ4æ ¸8GBï¼‰
- æ•°æ®åº“ï¼š1å°ï¼ˆ4æ ¸16GBï¼‰
- Redisï¼š1å°ï¼ˆ2æ ¸4GBï¼‰
- Ollamaæ¨ç†ï¼š1å°ï¼ˆ8æ ¸16GB + GPUå¯é€‰ï¼‰
- æ€»æˆæœ¬ï¼šçº¦ $200-300/æœˆï¼ˆäº‘æœåŠ¡ï¼‰

---

## å…«ã€é£é™©è¯„ä¼°

### 8.1 æŠ€æœ¯é£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|------|------|------|----------|
| Ollamaæ€§èƒ½ä¸è¶³ | é«˜ | ä¸­ | æä¾›äº‘ç«¯LLMå¤‡é€‰æ–¹æ¡ˆ |
| æ•°æ®åº“Schemaå˜æ›´ | ä¸­ | é«˜ | ä½¿ç”¨Alembicè¿ç§»ç®¡ç† |
| å‰ç«¯å¼€å‘å»¶æœŸ | é«˜ | ä¸­ | å…ˆå®ŒæˆAPIï¼Œå‰ç«¯é€æ­¥è¿­ä»£ |
| ç¬¬ä¸‰æ–¹æœåŠ¡æ•…éšœ | ä¸­ | ä½ | æ·»åŠ é™çº§å’Œé‡è¯•æœºåˆ¶ |

### 8.2 ä¸šåŠ¡é£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|------|------|------|----------|
| ç”¨æˆ·æ•°æ®éšç§ | é«˜ | ä¸­ | ç¬¦åˆGDPR/ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³• |
| åŒ»ç–—åˆè§„æ€§ | é«˜ | ä¸­ | æ·»åŠ å…è´£å£°æ˜ï¼Œéè¯Šæ–­å·¥å…· |
| ç”¨æˆ·ç•™å­˜ç‡ä½ | ä¸­ | é«˜ | å¢å¼ºæ¿€åŠ±æœºåˆ¶ã€æ¸¸æˆåŒ–è®¾è®¡ |

---

## ä¹ã€æˆåŠŸæŒ‡æ ‡ï¼ˆKPIï¼‰

### 9.1 æŠ€æœ¯æŒ‡æ ‡

- [ ] APIå“åº”æ—¶é—´ <100msï¼ˆP95ï¼‰
- [ ] ç³»ç»Ÿå¯ç”¨æ€§ >99%
- [ ] æµ‹è¯•è¦†ç›–ç‡ >80%
- [ ] ä»£ç è´¨é‡è¯„åˆ† >Bçº§ï¼ˆSonarQubeï¼‰

### 9.2 ç”¨æˆ·æŒ‡æ ‡

- [ ] æ³¨å†Œè½¬åŒ–ç‡ >30%
- [ ] 7æ—¥ç•™å­˜ç‡ >50%
- [ ] æ—¥æ´»è·ƒç”¨æˆ·ï¼ˆDAUï¼‰å¢é•¿
- [ ] ç”¨æˆ·æ»¡æ„åº¦ >4.0/5.0

### 9.3 ä¸šåŠ¡æŒ‡æ ‡

- [ ] å®Œæ•´è¯„ä¼°æµç¨‹ç”¨æˆ· >100
- [ ] å¹³å‡å¹²é¢„æ‰§è¡Œç‡ >60%
- [ ] å¥åº·æŒ‡æ ‡æ”¹å–„ç”¨æˆ·æ¯”ä¾‹ >40%

---

## åã€è”ç³»ä¸åä½œ

### 10.1 å›¢é˜Ÿè§’è‰²

- **é¡¹ç›®è´Ÿè´£äºº**ï¼šæ•´ä½“è§„åˆ’ã€å†³ç­–
- **åç«¯å·¥ç¨‹å¸ˆ**ï¼šæ ¸å¿ƒé€»è¾‘ã€APIå¼€å‘
- **å‰ç«¯å·¥ç¨‹å¸ˆ**ï¼šH5ç•Œé¢ã€Admin Portal
- **DevOpså·¥ç¨‹å¸ˆ**ï¼šéƒ¨ç½²ã€ç›‘æ§ã€è¿ç»´
- **äº§å“ç»ç†**ï¼šéœ€æ±‚ç®¡ç†ã€ç”¨æˆ·åé¦ˆ

### 10.2 æ²Ÿé€šæ¸ é“

- **ä»£ç ä»“åº“**ï¼šGitHub
- **ä»»åŠ¡ç®¡ç†**ï¼šJIRA / GitHub Projects
- **æ–‡æ¡£åä½œ**ï¼šNotion / Confluence
- **å³æ—¶é€šè®¯**ï¼šSlack / é£ä¹¦

---

## åä¸€ã€é™„å½•

### A. å…³é”®æ–‡ä»¶é€ŸæŸ¥

| ç”¨é€” | æ–‡ä»¶è·¯å¾„ |
|------|----------|
| APIå…¥å£ | `api/main.py` |
| æ ¸å¿ƒå¼•æ“ | `core/master_agent.py` |
| L2è¯„ä¼° | `core/assessment_engine.py` |
| Triggerå®šä¹‰ | `knowledge/triggers/trigger-tags-v1.json` |
| æ•°æ®Schema | `docs/CORE_DATA_SCHEMA_v1_SPECIFICATION.md` |
| æ¶æ„è¯´æ˜ | `docs/PROJECT_OVERVIEW_EXECUTIVE.md` |
| å·®è·åˆ†æ | `docs/GAP_ANALYSIS_BLUEPRINT.md` |

### B. å¸¸ç”¨å‘½ä»¤ï¼ˆç›®æ ‡çŠ¶æ€ï¼‰

```bash
# å¼€å‘
bh serve --reload          # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
bh test                    # è¿è¡Œæµ‹è¯•
bh lint                    # ä»£ç æ£€æŸ¥
bh format                  # ä»£ç æ ¼å¼åŒ–

# æ•°æ®åº“
bh db init                 # åˆå§‹åŒ–
bh db migrate              # è¿ç§»
bh db seed                 # ç§å­æ•°æ®

# ç”¨æˆ·ç®¡ç†
bh user create admin       # åˆ›å»ºç®¡ç†å‘˜
bh user list               # åˆ—å‡ºç”¨æˆ·
bh user reset-password     # é‡ç½®å¯†ç 

# ç³»ç»Ÿ
bh status                  # ç³»ç»ŸçŠ¶æ€
bh logs                    # æŸ¥çœ‹æ—¥å¿—
bh config                  # æŸ¥çœ‹é…ç½®
```

### C. ç›¸å…³èµ„æº

- **æŠ€æœ¯æ–‡æ¡£**ï¼š`docs/`ç›®å½•
- **APIæ–‡æ¡£**ï¼šhttp://localhost:8000/docsï¼ˆå¯åŠ¨åï¼‰
- **çŸ¥è¯†åº“**ï¼š`knowledge/`ç›®å½•
- **æµ‹è¯•æ•°æ®**ï¼š`data/profiles/`ç›®å½•

---

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨ï¼šç«‹å³å¼€å§‹ Phase 1 - Task 1.1ï¼ˆåˆ›å»ºCLIå…¥å£ï¼‰**

å®ç°"ç»ˆç«¯ç›´æ¥è¿è¡Œ"çš„æœ€å°ç›®æ ‡ï¼š
```bash
python -m behavioral_health serve
```

é¢„è®¡å®Œæˆæ—¶é—´ï¼š2-3å¤©
