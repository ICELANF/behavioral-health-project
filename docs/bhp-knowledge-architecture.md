# 行健平台 · 知识建设架构规则文档

> **文档定位**：本文档是行健平台知识体系建设的顶层指导原则，适用于平台现有 40+ AI Agent 的知识包设计、数据建设、Claude Code 集成及后期迭代扩展。
> 
> **覆盖范围**：知识建设策略 → 知识包设计规则 → 生产流程 → Claude Code 集成规范 → 质量校验 → 迭代维护
> 
> **版本**：V1.0 | **日期**：2026-02-25 | **基于对话**：MVP规划→Agent体系→决策树生产→Claude Code集成全流程

---

## 目录

1. [核心战略：三圆飞轮与知识建设的关系](#一核心战略三圆飞轮与知识建设的关系)
2. [知识建设的根本逻辑](#二知识建设的根本逻辑)
3. [知识分层架构](#三知识分层架构)
4. [Agent知识包设计规则](#四agent知识包设计规则)
5. [知识生产流程（可重复执行SOP）](#五知识生产流程可重复执行sop)
6. [Claude Code集成规范](#六claude-code集成规范)
7. [影子专家策略](#七影子专家策略)
8. [种子用户与知识验证](#八种子用户与知识验证)
9. [知识质量标准](#九知识质量标准)
10. [典型案例：代谢健康决策树知识包](#十典型案例代谢健康决策树知识包)
11. [常见错误与防范铁律](#十一常见错误与防范铁律)
12. [迭代与维护规则](#十二迭代与维护规则)
13. [待完善与补充清单](#十三待完善与补充清单)

---

## 一、核心战略：三圆飞轮与知识建设的关系

### 1.1 三圆飞轮模型

行健平台的价值创造依赖三个相互驱动的飞轮：

```
        ┌─────────────────┐
        │   底座飞轮       │
        │ 行为健康方法论    │
        │ BFR/TTM/BPT6    │
        └────────┬─────────┘
                 │ 方法论注入
        ┌────────▼─────────┐         ┌─────────────────┐
        │   专家飞轮        │◄────────│  知识建设       │
        │ 领域知识+Agent    │         │ 本文件的核心主题  │
        └────────┬─────────┘         └─────────────────┘
                 │ 工具赋能
        ┌────────▼─────────┐
        │   教练飞轮        │
        │ 教练用Agent帮用户  │
        └────────┬─────────┘
                 │ 数据反哺
                 └──────────► 底座飞轮（闭环）
```

**关键洞见**：知识建设的本质不是「往Agent里塞信息」，而是**把顶级专家的思维模式数字化，让教练通过AI工具获得10倍于自身的专业能力**。

### 1.2 知识是飞轮的燃料，不是装饰

| 如果知识建设做错了 | 飞轮会怎样 |
|---------|---------|
| 只有方法论，没有领域内容 | 教练用AI只会说正确废话 |
| 只有信息堆砌，没有决策结构 | AI给不出行动建议，变成搜索引擎 |
| 知识脱离情境，缺乏对话化 | Agent的回答和临床情境脱节 |
| 没有案例和铁律 | AI会在边界情况出安全事故 |
| 知识与Agent割裂，无法按需调用 | 信息堆在Claude Code里，永远不被读到 |

### 1.3 MVP阶段的知识建设优先级

**原则：用「最小可行知识包」启动，而非等待完美的知识库**

```
Phase 1（MVP启动）：
  10个高频情境 × 每情境1个知识包 → 验证Agent回答质量
  
Phase 2（种子扩展）：
  影子专家审核 → 修订 → 覆盖20个情境
  
Phase 3（生态涌现）：
  督导专家贡献领域知识 → 知识库自我生长
```

---

## 二、知识建设的根本逻辑

### 2.1 三个核心问题

在开始任何知识建设工作之前，必须先回答：

**问题1：这份知识服务于谁？**
- 行健平台的知识服务于**教练（AI副驾驶）**，不是直接服务用户
- 用户只能用「健康科普/情绪倾诉/危机干预」基础层
- 「行为处方/TTM判断/风险评估」教练专属层才是知识建设的核心目标

**问题2：Agent如何使用这份知识？**
- Agent不是「读了知识就能变聪明」
- Agent需要**结构化的决策树**：什么情境触发→判断逻辑是什么→给出什么话术→教练执行什么动作
- 知识 ≠ 信息，知识 = 信息 + 决策结构 + 执行话术 + 边界铁律

**问题3：如何验证知识质量？**
- 验证方法只有一个：**让真实教练用AI帮真实用户，看结果**
- 没有临床落地验证的知识包，无论写得多漂亮，都是猜测

### 2.2 知识的五个层次（观念→理念→概念→知识→应用）

每一个领域的知识建设都必须覆盖五个层次：

| 层次 | 含义 | 在知识包中的体现 |
|------|------|---------|
| **观念** | 这个领域的基本认知框架 | 为什么这个情境有代谢风险？ |
| **理念** | 指导干预的核心原则 | 嵌入而非对抗；行为余量设计 |
| **概念** | 可操作的定义和分类 | TTM六阶段；BPT6维度；M-Action优先级 |
| **知识** | 经过验证的内容体系 | 决策树6节点；代谢监测指标；铁律边界 |
| **应用** | 与具体情境的匹配 | Agent话术脚本；教练行动指令；实际案例 |

**规则：没有覆盖全部五层的知识包，不允许上线**。缺少「应用层」的知识包，等于把教材交给还没实习的医学生做手术。

---

## 三、知识分层架构

### 3.1 平台知识五层结构

> **V1.2更新**：根据《知识数据建立规范》，原三层架构升级为五层。新增Evidence层（权威证据）和语义规则层（行为约束引擎），分别位于L1底座之上和之下。

```
┌────────────────────────────────────────────────────────┐
│ Evidence层 权威证据层（决定红线与禁忌）                    │
│  ▸ WHO / NICE / ADA / AHA等一级权威来源                 │
│  ▸ Endocrine Society / ESC等二级来源                    │
│  ▸ 自动抓取 → 分类 → 人工审签 → EvidenceVault           │
│  ▸ 只产出：红线边界 / 权重调整 / 归档存证                 │
│  ▸ 不可见层：Agent无法直接访问，只能通过规则层消费         │
└───────────────────┬────────────────────────────────────┘
                    │ 约束规则生成
┌───────────────────▼────────────────────────────────────┐
│ 语义规则层 Semantic Layer（实时约束Agent输出）             │
│  ▸ L3语义规则（YAML格式，96条+）                         │
│  ▸ TTM阶段类（12条）：precontemplation→maintenance      │
│  ▸ 阻抗与动机类（12条）：MI/SDT触发-推断-允许效果        │
│  ▸ 失败/复发类（12条）：去羞耻化/正常化/外归因重构        │
│  ▸ 情绪与压力类（20条）：HRV/正念/压力超载信号           │
│  ▸ 认知偏差类（20条）：损失厌恶/现状偏差/全或无思维       │
│  ▸ 身份叙事类（20条）：自我否定/固定型认知/叙事重构       │
│  ▸ 规则引擎，不是RAG检索——比向量检索更精确的实时判断      │
└───────────────────┬────────────────────────────────────┘
                    │ 方法论支撑
┌───────────────────▼────────────────────────────────────┐
│ L1 行为健康底座知识（全Agent共享）                        │
│  ▸ BFR行为事实回溯六要素（B/F/R/S/T/P）                 │
│  ▸ TTM六阶段（S0~S5）判断逻辑                           │
│  ▸ BPT6六维行为倾向评估                                 │
│  ▸ CrisisAgent触发协议（全局铁律）                       │
│  ▸ 代谢安全红线（血糖/血压阈值）                          │
└───────────────────┬────────────────────────────────────┘
                    │ 叠加专业知识
┌───────────────────▼────────────────────────────────────┐
│ L2 领域专业知识（特定Agent使用）                          │
│  ▸ 代谢健康：胰岛素抵抗/CGM/皮质醇机制                   │
│  ▸ 中医体质：九种体质辨识/干预方案                        │
│  ▸ 营养学：GI/胰岛素指数/进食顺序机制                    │
│  ▸ 心理健康：认知扭曲类型/正念技术/动机访谈               │
│  ▸ 运动医学：心率区间/NEAT/肌肉代谢                      │
│  ▸ 慢病管理：糖尿病/高血压/代谢综合征干预协议             │
└───────────────────┬────────────────────────────────────┘
                    │ 匹配情境
┌───────────────────▼────────────────────────────────────┐
│ L3 情境化决策知识（决策树/对话脚本/铁律）                  │
│  ▸ 10个饮食行为干预情境（S01~S10决策树）                  │
│  ▸ 情境触发关键词→情境识别→节点路由                       │
│  ▸ Agent话术脚本（低/中/高信任度三档变体）                │
│  ▸ 教练行动指令（教练审核要点和跟进动作）                  │
│  ▸ 代谢监测阈值与干预策略                                 │
│  ▸ 铁律边界（禁止动作+医疗转诊条件）                      │
└────────────────────────────────────────────────────────┘
```

### 3.2 五层的本质区别

| 层级 | 存储形式 | 调用方式 | 谁来写 | 更新频率 |
|------|---------|---------|-------|---------|
| Evidence层 | PDF/HTML原文+元数据 | 不可直接调用，通过审签转化为规则 | 自动抓取+人工审签 | 跟随指南发布 |
| 语义规则层 | YAML规则文件 | 规则引擎实时匹配，非RAG检索 | 专家+产品团队 | 季度评审 |
| L1底座 | Markdown文件 | RAG T2层召回 | 平台团队 | 方法论更新时 |
| L2领域 | Markdown文件 | RAG T2层召回 | 影子专家 | 指南更新时 |
| L3情境 | Markdown文件 | RAG T3层精准召回 | 影子专家+教练 | 种子测试后 |

### 3.3 三类数据的严格隔离

> **新增原则**：以下三类数据存放位置不同，不可混用。

```
知识库（RAG）        ← 存评估解读框架、干预规则、话术脚本
                        例："BPT6 P2低分 → 需极低门槛Slack"

语义规则引擎         ← 存行为状态触发-推断-允许效果三元组
                        例："trigger:反复权衡利弊 → inference:contemplation"

用户数据库           ← 存每个用户的评估结果、当前阶段、历史数据
                        例："张三的P2=3分，当前TTM=S2"
```

**调用链路**：
```
用户说话 → 语义规则引擎实时判断状态
         → RAG召回对应知识包
         → 用户数据库补充个人画像
         → Agent生成个性化回应
```

### 3.2 知识与Agent的映射关系

| Agent名称 | 使用L1 | 使用L2领域 | 使用L3情境 |
|----------|-------|----------|----------|
| CoachCopilotAgent | ✅ | 所有 | 所有情境 |
| MetabolicAgent | ✅ | 代谢健康+营养 | S01,S04,S06 |
| BehaviorRxAgent | ✅ | 心理+行为科学 | S03,S09,S10 |
| FamilyContextAgent | ✅ | 家庭系统+文化 | S02 |
| WorkplaceAgent | ✅ | 职场心理+运动 | S05,S07 |
| ExerciseAgent | ✅ | 运动医学 | S08 |
| TCMAgent | ✅ | 中医体质 | S02,S09 |
| CrisisAgent | ✅（安全层） | 心理危机 | 全局触发 |

---

## 四、Agent知识包设计规则

### 4.1 知识包的标准结构（强制）

每一个情境知识包必须包含以下8个模块，缺一不可：

```markdown
# [情境编号] · [情境名称] — [用户典型自述]

## 1. 适用识别条件（触发层）
- TTM阶段范围
- 信任分范围
- BPT6特征描述
- 触发关键词列表（6~10个）
- 代谢风险背景

## 2. 干预核心逻辑（一句话总结）
- 干预方向
- 代谢核心（为什么这个方向对代谢有效）

## 3. 决策树（执行层）
- 6个节点（每节点含：触发条件/Agent话术/教练行动）
- 节点间流转逻辑
- 情境转接规则（何时转入其他情境协议）

## 4. M-Action清单（行动层）
- P1~P5优先级排列
- 每条含：具体行动 + 代谢机制说明

## 5. 代谢监测重点（监测层）
- 4项关键指标
- 每项含：风险阈值 + 行为健康干预方向

## 6. 铁律边界（安全层）
- 4条禁止动作及原因
- 医疗转诊触发条件

## 7. 叠加情境提示（联动层）
- 最高频叠加组合
- 情境间处理优先级

## 8. 话术变体库（扩展层，V2.0后添加）
- 每个节点3~5个话术变体
- 不同信任等级下的话术调整
```

### 4.2 知识包格式强制规范

**文件命名规则**：
```
[领域代码]_[情境序号]_[情境关键词].md

示例：
dietary_s01_emotion.md       ← 饮食领域/情境01/情绪进食
tcm_qi_deficiency.md         ← 中医领域/气虚体质
exercise_cardiac_rehab.md    ← 运动领域/心脏康复
```

**内容写作规范**：
- 语言：中文，专业术语后加括号注英文
- 话术：必须是可直接使用的完整句子，不是「建议说一些安慰的话」
- 阈值：必须给出具体数值，不是「较高时需注意」
- 铁律：必须给出「禁止的原因」，不只是「禁止XX」
- 代谢机制：必须说明「为什么这个行为改善代谢」的生理路径，不只是说「有益健康」

### 4.3 知识包大小控制

| 知识包类型 | 推荐行数 | 原因 |
|---------|---------|------|
| 单一情境决策树 | 120~160行 | 覆盖8模块，Claude Code按需加载 |
| 领域概览索引（README） | 80~100行 | 路由表+跨情境原则+触发索引 |
| CLAUDE.md入口 | 60~100行 | 只放导航和全局铁律，不放详细内容 |
| L1底座知识 | 200~300行 | 全Agent共享，可一次性加载 |

**反模式（禁止）**：
- ❌ 把所有10个情境都写进一个文件 → Context Window爆炸，知识在噪音中消失
- ❌ CLAUDE.md超过200行 → 每次启动消耗大量Token，降低Claude Code工作质量
- ❌ 用连续段落写话术 → Agent解析困难，无法精准提取

---

## 五、知识生产流程（可重复执行SOP）

### 5.1 知识包生产的五步法

```
Step 1: 情境识别（1~2小时）
  ├─ 从实训教材/临床案例中提取高频情境
  ├─ 识别情境的TTM阶段分布、BPT6特征
  ├─ 确认代谢风险背景（有代谢指标关联才值得建知识包）
  └─ 产出：情境卡片（50字内描述情境核心）

Step 2: 决策树骨架（2~4小时）
  ├─ 设计6个决策节点（入场→识别→解码→干预→行动→复发处理）
  ├─ 每节点写触发条件（可测量的判断标准）
  ├─ 定义情境转接规则（何时转入其他协议）
  └─ 产出：决策树骨架（可用表格或流程图表达）

Step 3: 内容填充（4~8小时）
  ├─ 为每个节点写Agent话术（完整句子，不是关键词）
  ├─ 为每个节点写教练行动指令（可执行的具体动作）
  ├─ 完成M-Action清单（P1~P5，附代谢机制）
  ├─ 填写代谢监测阈值（基于临床参考值）
  └─ 产出：知识包初稿

Step 4: 影子专家审核（2~4小时）
  ├─ 找1~2位有临床经验的专家逐节点审核
  ├─ 重点检查：话术是否临床可用、阈值是否准确、铁律是否完整
  ├─ 补充专家「隐性知识」（无法从教材中提取的临床判断）
  └─ 产出：审核意见+修订版

Step 5: 种子测试（1~2周实际使用）
  ├─ 5~10位教练在真实服务中使用
  ├─ 记录哪些节点「答非所问」、哪些铁律缺失
  ├─ 收集代谢指标改善数据（有无真实代谢改善）
  └─ 产出：V1.1修订版 + 测试报告
```

### 5.2 知识来源优先级

| 优先级 | 来源 | 质量评估 | 适用场景 |
|--------|------|---------|---------|
| P1 | 已完成临床实践的案例记录 | 最高，经过现实验证 | 铁律和话术 |
| P2 | 影子专家的隐性知识 | 高，来自专业经验 | 决策节点和干预逻辑 |
| P3 | 权威培训教材和指南 | 高，经过审核 | 理论框架和阈值参考 |
| P4 | 同行共识和实践总结 | 中，需要交叉验证 | 补充内容 |
| P5 | AI辅助生成的初稿 | 低，必须专家审核 | 草稿生产加速 |

**规则**：P5来源（AI生成）的知识内容，在影子专家审核前，不得标记为「可用于教练服务」。

### 5.3 知识生产的役割分工

| 角色 | 知识建设中的职责 |
|------|--------------|
| 平台技术团队 | 定义文件格式、部署目录结构、维护CLAUDE.md和README |
| 影子专家（核心贡献者） | 审核知识准确性、提供隐性知识、验证铁律边界 |
| 初级知识编辑（可用AI加速） | 按SOP生产知识包初稿、格式规范化、整理文件命名 |
| L3+教练（验证者） | 在真实服务中测试知识包有效性、反馈话术适用性 |
| 管理员/CTO | 定期审核知识库健康度、决定知识包升级或退役 |

---

## 六、Claude Code集成规范

### 6.1 目录结构规范（强制）

```
[项目根目录]/
├── CLAUDE.md                        ← 启动自动加载（只放导航+全局铁律）
│
└── docs/
    └── knowledge/
        ├── README.md                ← 知识库索引（路由表+跨情境原则）
        │
        ├── [领域前缀]_[编号]_[关键词].md   ← 情境知识包
        │
        ├── dietary_s01_emotion.md
        ├── dietary_s02_family.md
        ├── ...（情境文件按需扩展）
        │
        ├── base/                    ← L1底座知识（全Agent共享）
        │   ├── bfr_framework.md     ← BFR方法论
        │   ├── ttm_stages.md        ← TTM六阶段
        │   └── crisis_protocol.md  ← CrisisAgent触发协议
        │
        └── domain/                  ← L2领域知识
            ├── metabolic/
            ├── tcm/
            ├── nutrition/
            └── exercise/
```

### 6.2 CLAUDE.md写作规范

**CLAUDE.md = 导航地图，不是知识百科**

```markdown
# 正确的CLAUDE.md写法

## 知识库导航
→ 索引：@docs/knowledge/README.md

| 触发关键词 | 加载哪个文件 |
|-----------|------------|
| 情绪/压力/奶茶 | @docs/knowledge/dietary_s01_emotion.md |
...

## 全局铁律（3~5条核心约束）
- AI→教练审核→推送，绝不直接触达用户
- 代谢危险信号 → 必须联动医疗
- 出现危机信号 → 立即触发CrisisAgent

## 项目结构（10行以内的简洁版）
...
```

**CLAUDE.md禁止放的内容**：
- ❌ 详细的决策树内容（放到具体的知识包文件）
- ❌ 代谢指标的详细参考范围（放到领域知识文件）
- ❌ 话术脚本（放到情境文件）
- ❌ 超过5条的规则列表（精炼到最重要的）

### 6.3 知识调用的三种模式

**模式A：启动时自动加载（CLAUDE.md）**
```
适用：全局规则和导航
内容：项目概述、知识库路由表、全局铁律、代码规范
消耗Token：每次启动约2000~4000 tokens
```

**模式B：按需@引用（对话中显式引用）**
```
适用：具体任务需要特定知识时
触发方式：@docs/knowledge/dietary_s01_emotion.md
消耗Token：文件大小（约3000~5000 tokens/文件）
使用场景：
  "帮我给S01情绪进食写CoachCopilotAgent的system prompt，
   参考 @docs/knowledge/dietary_s01_emotion.md"
```

**模式C：子目录CLAUDE.md按需加载**
```
适用：进入特定目录工作时
触发：Claude Code访问该目录下的文件时自动加载
使用场景：docs/knowledge/domain/metabolic/CLAUDE.md 中放代谢知识导读
```

### 6.4 Agent配置文件与知识包的严格隔离

**规则：Agent的system prompt（配置文件）不纳入RAG入库流程，与知识包严格隔离。**

依据：
- system prompt是「Agent运行规则」，不是「知识内容」，不属于L1/L2/L3任何一层
- 入库后向量检索可能将「禁止道德评判」「输出格式规范」等运行规则召回，挤占情境知识包的检索空间，降低T3层召回精度
- 与CLAUDE.md的设计先例一致——整体加载的规则文件不参与按需检索

**存放规范**：
```
docs/agents/                          ← Agent配置文件目录
├── coach_copilot_agent_prompt.md     ← CoachCopilotAgent system prompt
└── [其他Agent]_prompt.md             ← 后续Agent依此命名
```

- 开发团队手动注入Agent的 `system` 字段，不走自动入库流程
- `docs/agents/` 目录需在RAG入库脚本中显式排除（`exclude_dirs: ["docs/agents"]`）
- 知识库README的「Agent配置文件」章节单独列出，注明「不参与RAG检索」

---

### 6.5 Context Window管理原则

**核心原则：只在需要的时候加载需要的知识，不全量注入**

| 场景 | 正确做法 | 错误做法 |
|------|---------|---------|
| 开发CoachCopilotAgent | 按需加载涉及情境的2~3个文件 | 一次性加载全部10个情境文件 |
| 调试代谢监测逻辑 | 只加载metabolic/相关文件 | 把所有知识包全部@进来 |
| 写单元测试 | 不加载知识文件 | 加载大量知识文件 |
| 全系统review | 先看README索引，再按需深入 | 直接让Claude读完所有文件 |

**Context rot警告**：当Context Window装满了大量知识内容后，Claude Code对代码文件的理解和修改质量会显著下降，不是文件多就等于更聪明。

---

## 七、影子专家策略

### 7.1 什么是影子专家

影子专家是平台在早期无法吸引公开背书专家时的核心知识来源——**专家以非公开方式提供专业知识，由平台整理和数字化，利润分享但不公开署名**。

```
影子专家模型：
  专家提供：临床案例 + 隐性知识 + 铁律边界 + 话术校准
  平台提供：数字化整理 + 知识包生产 + Agent部署 + 收益分成
  结果：  Agent拥有真实临床经验，不是AI臆造的话术
```

### 7.2 影子专家招募优先领域

根据平台40+Agent的分布，招募优先级：

| 优先级 | 领域 | 对应Agent | 影子专家类型 |
|--------|------|---------|----------|
| P1 | 代谢/内分泌 | MetabolicAgent | 内分泌科医师 / 代谢科医师 |
| P1 | 行为健康教练 | CoachCopilotAgent | 资深健康教练 / 心理咨询师 |
| P2 | 中医体质 | TCMAgent | 中医师 / 全科中医 |
| P2 | 营养学 | NutritionAgent | 注册营养师 / 临床营养科 |
| P3 | 运动医学 | ExerciseAgent | 运动康复师 / 运动处方师 |
| P3 | 心理支持 | SupportAgent | 心理咨询师 / 精神科医师 |

### 7.3 影子专家贡献知识的标准流程

```
Step 1：知识采集会议（1~2小时录音/笔记）
  问题框架：
  - 「你在临床中最常遇到这类问题的什么变体？」
  - 「什么情况下你会立刻升级处理？」
  - 「哪些话你绝对不会对这类患者说？」
  - 「你判断这个阶段的方式和教材有什么不同？」

Step 2：隐性知识提取（AI辅助整理）
  - 将录音转写为文字
  - 用AI提炼「判断逻辑」和「话术模式」
  - 识别与教材的差异（差异处往往是最有价值的隐性知识）

Step 3：知识包草稿生成
  - 将隐性知识填入标准知识包模板
  - 特别标注「来自临床经验」vs「来自教材」的内容
  
Step 4：专家二轮审核
  - 专家审核草稿：哪些理解有偏差？哪些场景漏掉了？
  - 调整后确认「可用于教练服务」
```

---

## 八、种子用户与知识验证

### 8.1 种子用户的战略价值

种子用户不只是「第一批使用者」，他们是**知识质量的活体检验场**。

```
知识包上线前：影子专家审核（理论质量）
知识包上线后：种子用户验证（实践质量）

只有通过种子验证的知识包，才进入生产环境
```

### 8.2 种子用户组合设计

| 用户类型 | 数量 | 使用目的 |
|---------|------|---------|
| 行为健康教练（L3+） | 5~10人 | 验证Agent话术在真实服务中是否可用 |
| 慢病患者（高配合度） | 10~20人 | 验证M-Action是否实际可执行 |
| 医护人员（审查视角） | 2~3人 | 验证代谢阈值和铁律是否符合医学标准 |

### 8.3 知识验证指标

```
一级指标（必须达标才可正式上线）：
  □ 教练使用满意度 ≥ 70%（「这个回答对我有帮助」）
  □ 话术可用率 ≥ 60%（「这句话我可以直接用」）
  □ 零安全事故（无因AI建议引发医疗风险的案例）

二级指标（上线后持续追踪）：
  □ 用户行为改变率：2周内完成P1 M-Action的比例 ≥ 40%
  □ 教练干预效率：单用户教练工作时间是否下降
  □ 代谢指标改善：使用知识包的用户代谢指标趋势

三级指标（季度评估）：
  □ 知识包调用频率（哪些情境真的被用？）
  □ 话术偏差率（教练实际使用了多少AI建议的话术？）
```

---

## 九、知识质量标准

### 9.1 完整性检查清单

每份知识包上线前，必须通过以下检查：

```
内容完整性：
  □ 8个标准模块全部填写
  □ 决策树有6个节点
  □ 每节点包含触发条件/话术/教练行动
  □ M-Action ≥ 5条，含代谢机制说明
  □ 代谢监测指标 ≥ 4项，含具体阈值
  □ 铁律边界 ≥ 4条，含禁止原因
  □ 至少1个叠加情境提示

话术质量：
  □ 所有话术是完整句子，不是关键词
  □ 话术中没有「可能/也许/或许」的模糊表达
  □ 话术不包含道德评判性语言
  □ 话术与TTM阶段和信任分匹配

安全边界：
  □ 代谢危险阈值与临床参考值一致
  □ CrisisAgent触发条件明确写出
  □ 铁律中包含医疗转诊条件
  □ 没有「保证/一定/肯定」等过度承诺的表达

格式规范：
  □ 文件名符合命名规范
  □ Markdown标题层级正确（H1/H2/H3）
  □ 表格格式正确（可渲染）
  □ 行数在120~160行范围内
```

### 9.2 知识包评级标准

| 等级 | 说明 | 可用状态 |
|------|------|---------|
| 🟢 A级（生产就绪） | 完整8模块 + 影子专家审核 + 种子测试通过 | 可上线供教练使用 |
| 🟡 B级（测试中） | 完整8模块 + 影子专家审核（未完成种子测试） | 限定5人以内教练测试 |
| 🟠 C级（草稿） | 完整8模块（未经专家审核） | 仅供内部参考，禁止用于真实服务 |
| 🔴 D级（残缺） | 模块不完整或缺失安全边界 | 禁止使用，必须补全 |

---

## 十、典型案例：代谢健康决策树知识包

### 10.1 案例背景

代谢健康决策树是目前最完整的实践案例，提供了可复用的参考范式。

**建设过程**：
1. 原始素材：「行为健康教练初级师实训资料.docx」（4,050行）
2. 提取高风险情境：10个饮食行为干预情境（聚焦代谢/内分泌主线）
3. 生成决策树文档（.docx）→ 转化为Markdown知识包（.md）
4. 部署到Claude Code目录结构

### 10.2 这套知识包的设计亮点

```
亮点1：情境触发词精准设计
  每个情境有6~10个触发关键词，覆盖用户不同表达方式
  → 解决了「用户不会用行话」的问题

亮点2：代谢机制全部显性化
  每条M-Action都附有代谢机制说明（如：皮质醇→胰岛素抵抗的路径）
  → 让Agent能解释「为什么做这个有用」，增加用户信服度

亮点3：铁律反向设计
  每条铁律都包含「禁止的原因」
  → 让Agent理解「不能做」的底层逻辑，而不只是记住规则

亮点4：叠加情境显性化
  最高频叠加组合（如S01+S03）给出处理优先顺序
  → 解决了真实临床中「多情境并发」时AI不知所措的问题

亮点5：嵌入而非替代的干预哲学
  所有干预策略遵循「不改变现有生活，悄悄置换伤害」的原则
  → 解决了「依从性差」的核心问题
```

### 10.3 这套案例的局限与下一步

```
当前局限：
  - 话术只有单一版本（未做信任等级变体）
  - 缺少医护人员版话术（目前为教练版）
  - 没有接受种子用户测试（尚为B级）
  - 缺少L2领域知识文件支撑（代谢机制/营养学原理等）

下一步建设（V1.1）：
  - 招募2~3位内分泌科医师做影子专家审核
  - 5位教练做2周种子测试
  - 补充docs/knowledge/domain/metabolic/ L2知识文件
  - 为每节点增加「低信任版」和「高信任版」话术变体
```

---

## 十一、常见错误与防范铁律

### 11.1 知识建设的七大常见错误

**错误1：知识建设从「我有什么信息」出发，而非「Agent需要做什么决策」**
- 表现：把教材直接转换为Markdown，没有决策树结构
- 后果：Agent读了很多，但给不出具体建议
- 修正：先设计决策树节点，再往节点里填内容

**错误2：话术太通用，没有情境特异性**
- 表现：「建议您保持积极的心态，逐步改善饮食习惯」
- 后果：用户感觉AI是在背稿，信任崩塌
- 修正：话术必须包含情境特有的细节（如奶茶/火锅/应酬等具体行为词）

**错误3：铁律只有结论，没有原因**
- 表现：「禁止道德评判」（没有为什么）
- 后果：Agent在边缘情境下不知道为何要遵守规则，可能被「合理化」地绕过
- 修正：每条铁律必须有「原因」：「禁止道德评判，原因：羞耻感本身是下次情绪进食的触发器」

**错误4：知识包无版本管理，修改无迹可查**
- 表现：「最新版」知识包覆盖了之前有效的内容
- 后果：无法追溯哪次修改引发了Agent行为变化
- 修正：文件名加版本号，或使用Git管理知识包文件

**错误5：全部知识都塞进CLAUDE.md**
- 表现：CLAUDE.md有500行，包含全部决策树和话术
- 后果：每次Claude Code启动消耗大量Token，Context Window装满通用知识，没空间做实际工作
- 修正：CLAUDE.md只放60~100行导航，详细内容放到docs/knowledge/子文件

**错误6：知识包只经过AI生成，未经人工审核**
- 表现：「AI写的内容挺专业的，应该没问题」
- 后果：AI会自信地生成看起来合理但医学上错误的内容（如血糖阈值错误、禁忌症遗漏）
- 修正：所有知识包必须经影子专家审核，才能标记为B级及以上

**错误7：知识建设与Agent开发脱节**
- 表现：知识包写好了，但开发团队不知道放在哪里/怎么让Agent使用
- 后果：知识包是文档，不是知识；Agent仍然用通用知识回答
- 修正：知识建设团队和Agent开发团队必须共同设计文件位置和调用方式

### 11.2 全局铁律（最高优先级）

以下铁律适用于所有知识包，不可在任何情境下绕过：

```
铁律1：代谢安全红线
  血糖 < 2.8 或 > 16.7 mmol/L → 停止行为干预，立即触发CrisisAgent联系医疗
  血压 > 180/110 mmHg → 停止运动建议，立即要求医疗评估

铁律2：心理危机红线
  「活着没意思」「不想活了」或类似表达 → 立即触发CrisisAgent，停止所有行为干预
  无助感评分 ≥ 9/10 + 无望感组合 → 心理健康评估优先于代谢管理

铁律3：AI输出审核红线
  AI的任何「建议」都不允许绕过教练审核直接触达用户
  无论话术多么准确，都必须经过CoachPushQueue

铁律4：医疗权限红线
  行为健康Agent不得替代医疗诊断
  出现以下情况必须明确建议用户联系医疗：
    - 代谢指标持续恶化（血糖>11.1连续2次）
    - 血压持续>140/90
    - HbA1c>8%
    - 肾功能异常（eGFR降低）
```

---

## 十二、迭代与维护规则

### 12.1 知识包版本升级触发条件

| 触发事件 | 升级行动 | 优先级 |
|---------|---------|--------|
| 影子专家发现医学错误 | 立即修订，标记D级直至修复 | 紧急 |
| 代谢指标阈值被医学指南更新 | 1周内修订 | 高 |
| 5个以上教练反馈某话术不可用 | 2周内修订话术 | 高 |
| 种子测试发现依从率<30% | 重新设计M-Action | 中 |
| 新情境出现（新的高频用户问题） | 新建知识包 | 中 |
| 叠加情境处理出现混乱 | 修订叠加情境提示 | 低 |

### 12.2 知识库健康度季度评估

每季度执行一次知识库健康度评估：

```
评估维度1：覆盖率
  □ 最高频的30个用户情境，有多少有知识包？（目标≥70%）
  □ 哪些领域的Agent还在依赖通用知识？（需要补建）

评估维度2：准确率
  □ 上季度有无代谢指标阈值投诉或安全事件？
  □ 影子专家复审发现了多少内容偏差？

评估维度3：使用率
  □ 哪些知识包被Claude Code引用频率最高/最低？
  □ 低引用的知识包：是内容不好，还是触发词设计有问题？

评估维度4：临床转化率
  □ 教练使用AI建议的话术占比（越高=知识包越好）
  □ 用户执行M-Action的比例（越高=干预设计越好）
```

### 12.3 知识库退役规则

以下情况，知识包应退役（不删除，降级为历史归档）：

- 对应的TTM情境在真实服务中出现频率低于1次/月
- 医学指南更新导致干预策略需要全面重建
- 被合并入更完整的综合情境知识包中
- 影子专家评估认为整体框架需要推翻重建

---

## 十三、待完善与补充清单

### 13.1 当前已完成（V1.2）

```
✅ 10个饮食行为干预情境知识包（dietary_s01~s10）
✅ S01~S10 全部补齐低/中/高信任度三档话术变体库
✅ L1底座知识文件（base/目录，4个文件）：
    ✅ base/bfr_framework.md      BFR六要素+有效/无效对比案例
    ✅ base/ttm_stages.md         TTM六阶段+流转规则+铁律
    ✅ base/bpt6_dimensions.md    BPT6六维+策略权重+应用规则
    ✅ base/crisis_protocol.md    CrisisAgent触发协议+话术模板
✅ 知识库索引README.md（含Agent配置文件隔离说明）
✅ CLAUDE.md入口文件
✅ CoachCopilotAgent system prompt（docs/agents/，不入RAG）
✅ 知识建设架构规则文档（五层架构版）
✅ RAG入库：401 chunks，100% embedded（T2=5文件，T3=10文件）
```

### 13.2 下一阶段必须建设（V1.3，优先级P1）

```
□ 语义规则层（独立于RAG的规则引擎）：
    semantic/ttm_rules.yaml         TTM阶段类12条规则
    semantic/resistance_rules.yaml  阻抗与动机类12条规则（MI/SDT）
    semantic/relapse_rules.yaml     失败/复发类12条规则
    semantic/stress_rules.yaml      情绪与压力类20条规则
    semantic/cognitive_rules.yaml   认知偏差类20条规则（行为经济学）
    semantic/identity_rules.yaml    身份叙事类20条规则
    → 总计96条+，格式：trigger/inference/allowed_effects三元组

□ Evidence层基础设施：
    evidence/source_registry.yaml   权威来源白名单（WHO/NICE/ADA等）
    evidence/review_workflow.md     审签SOP（5字段标准）
    evidence/evidence_vault/        已审签指南存档目录

□ 影子专家审核记录：
    docs/knowledge/review/dietary_s01_review.md（先做S01，升A级）

□ L2代谢领域知识（domain/metabolic/目录）：
    metabolic/cortisol_mechanism.md    皮质醇-胰岛素抵抗机制
    metabolic/cgm_interpretation.md    CGM数据解读指南（教练版）
    metabolic/metabolic_biomarkers.md  代谢监测指标参考范围
```

### 13.3 V2.0规划（6个月内）

```
□ 行为诊断与处方类评估解读知识包：
    assessment/bfive_interpretation.md   大五人格评估解读框架
    assessment/tcm_constitution.md       中医九种体质辨识与干预
    assessment/metabolic_risk.md         代谢风险分级评估解读
    assessment/behavior_rx.md            行为处方匹配规则
    （评估解读框架入RAG；用户个人评估结果入用户数据库，不入RAG）

□ 视频资产调度层（Video × Behavior × Agent）：
    video/video_asset_registry.yaml     视频资产主表
    video/dispatch_rules.yaml           调度触发规则（绑定TTM/BPT6状态）
    video/effect_dashboard.md           行为指标评估框架

□ 语义规则A/B实验框架
□ 中医体质专项知识包（9种体质各一份）
□ 医护人员专用话术版本
□ 知识包使用数据仪表板
□ 自动化格式验证工具（pre-commit检查）
```

### 13.4 长期建设方向（1年内）

```
□ Evidence层全自动抓取管道（Fetcher→Classifier→VersionDiff→HumanReview）
□ 语义规则与CGM/HRV实时信号的触发映射
□ 督导专家贡献机制（专家激励+知识版权分层协议）
□ 知识包自动老化预警（基于指南更新检测）
□ 案例知识库（真实脱敏案例→逆向补充知识包）
□ 多语言支持（繁体中文/英文）
□ Agent知识市场（优质知识包可单独销售）
```

---

## 附录A：知识包快速检查清单（打印版）

```
□ 文件名符合规范：[领域]_[编号]_[关键词].md
□ 8个模块全部存在
□ 情境触发词 ≥ 6个
□ 决策树节点数 = 6
□ 每节点包含3要素（触发/话术/教练行动）
□ M-Action ≥ 5条，有代谢机制
□ 代谢监测指标 ≥ 4项，有阈值
□ 铁律 ≥ 4条，有原因
□ 包含医疗转诊条件
□ 包含叠加情境提示
□ 话术无道德评判性语言
□ 话术无过度承诺表达
□ 行数在120~160行
□ 影子专家已审核（B级及以上必须）
□ 种子测试已通过（A级必须）
```

## 附录B：文件引用速查

```
在Claude Code对话中引用知识文件的方法：

# 引用单个情境文件
@docs/knowledge/dietary_s01_emotion.md

# 引用知识库索引
@docs/knowledge/README.md

# 引用底座知识
@docs/knowledge/base/bfr_framework.md

# 引用领域知识
@docs/knowledge/domain/metabolic/cgm_interpretation.md

# 组合引用（处理叠加情境）
"参考 @docs/knowledge/dietary_s01_emotion.md 
 和 @docs/knowledge/dietary_s03_spiral.md
 处理S01+S03叠加情境"
```

---

*本文档版本 V1.0 | 基于行健平台 MVP规划→Agent体系→决策树生产→Claude Code集成 完整对话提炼*  
*下一次更新节点：完成V1.1知识包（base/目录建立+影子专家审核）后升版至V1.1*
