# 行为健康平台 - 完整服务清单

> 最后更新: 2026-02-03

---

## 📋 服务总览

| 类型 | 服务名称 | 端口 | 状态 | 访问方式 |
|------|----------|------|------|----------|
| 前端 | H5 移动端 | 5173 | ✅ | http://localhost:5173 |
| 前端 | Admin Portal | 5174 | ✅ | http://localhost:5174 |
| 前端 | H5 患者应用 | 5175 | ✅ | http://localhost:5175 |
| 前端 | H5 患者应用(备用) | 5176 | ✅ | http://localhost:5176 |
| 前端 | Admin Portal(备用) | 5177 | ✅ | http://localhost:5177 |
| 后端 | Agent Gateway | 8000 | ✅ | http://localhost:8000/docs |
| 后端 | BAPS 评估 API | 8001 | ✅ | http://localhost:8001/docs |
| 后端 | 决策引擎+教练 | 8002 | ✅ | http://localhost:8002/docs |
| 基础 | Dify AI 平台 | 8080 | ✅ | http://localhost:8080 |
| 基础 | Ollama LLM | 11434 | ✅ | http://localhost:11434 |

---

## 🎯 核心功能页面对应表

### 1. 四角色登录页面 (您要找的第一个页面)

**位置**: Admin Portal 登录页
**访问地址**:
- http://localhost:5174/#/login
- http://localhost:5177/#/login (备用)

**功能特点**:
- 2×2 方形网格布局
- 四类角色选择：
  - 👤 自我管理 (患者) → 跳转 /client
  - 🧑‍⚕️ 健康教练 → 跳转 /coach-portal
  - 👨‍🔬 督导专家 → 跳转 /expert-portal
  - ⚙️ 系统管理 → 跳转 /dashboard

**测试账号**:
```
患者: patient / 123456
教练: coach / 123456
专家: expert / 123456
管理员: admin / admin123
```

---

### 2. 绿色用户界面 (您要找的第二个页面)

**位置**: Admin Portal 患者主页
**访问地址**:
- http://localhost:5174/#/client
- http://localhost:5177/#/client (备用)

**完整功能清单**:

#### ✅ 每日任务系统
- 任务列表展示 (高/中/低优先级)
- 任务打卡完成
- 完成任务获得积分 (+10分/任务)
- 任务完成进度统计
- 连续打卡天数记录

#### ✅ 用药提醒功能
- 今日用药打卡列表
  - 二甲双胍 500mg (早/晚餐后)
  - 格列美脲 2mg (早餐前)
  - 阿卡波糖 50mg (随餐)
- 用药时间提醒
- 药物功能说明
- 用药注意事项 (6条详细说明)
- 服药记录追踪
- 用药依从率统计

#### ✅ 学习内容推荐
**推荐视频** 🎬
- 视频缩略图展示
- 播放时长显示
- 观看次数统计
- 讲师信息
- 横向滚动卡片

**精选课程** 📚
- 课程封面图
- 课程评分 (星级)
- 学习人数
- 课程价格
- 讲师头像

#### ✅ 教练行为推荐
- 教育类指导 (📖 Education)
- 引导类指导 (🎯 Guidance)
- 教练类指导 (💪 Coaching)
- 支持类指导 (❤️ Support)
- 难度分级 (简单/中等/进阶)
- 预计时长

#### ✅ 健康指标卡片
- 🩸 空腹血糖监测 (实时值 + 趋势)
- ⚖️ 当前体重 (实时值 + 目标)
- 🏃 本周运动 (分钟数 + 进度条)
- 💊 用药依从率 (百分比 + 进度条)

#### ✅ AI 健康助手
- 💬 健康咨询
- 🥗 饮食指导
- 🏋️ 运动计划
- 🧘 心理支持

#### ✅ 其他特性
- 健康评分 (圆形进度条)
- 连续打卡统计 (🔥 图标)
- 积分系统 (⭐ 图标)
- 关注领域自定义 (血糖/饮食/运动/用药/睡眠/压力/体重)
- 底部导航栏 (首页/数据/聊天/学习/我的)

**设计特点**:
- 绿色主题配色 (#10b981, #16a34a)
- 紫色渐变头部 (#667eea → #764ba2)
- 卡片圆角 16px
- 柔和阴影效果
- 流畅动画过渡

---

## 📱 前端应用详细说明

### H5 移动端 (:5173)

**技术栈**: Vue 3 + Vant + Echarts
**定位**: 移动优先的健康管理应用
**主要功能**:
- 健康数据录入
- 图表数据可视化
- 移动端交互优化

**访问方式**:
```
http://localhost:5173
```

---

### Admin Portal (:5174, :5177)

**技术栈**: Vue 3 + Ant Design Vue + TypeScript
**定位**: 统一管理后台 (多角色)
**主要模块**:

#### 登录模块
- 路径: `/login`
- 功能: 四角色选择 + 账号密码登录
- 测试账号: 见上方

#### 患者模块 (Client)
- 首页: `/client` ⭐ **绿色用户界面**
- AI聊天: `/client/chat`
- 数据面板: `/client/device-dashboard`
- 学习进度: `/client/learning-progress`
- 个人档案: `/client/my/profile`
- 设备管理: `/client/my/devices`
- 测评记录: `/client/my/assessments`
- 行为轨迹: `/client/my/trajectory`

#### 教练模块 (Coach)
- 工作台: `/coach-portal`
- 学员管理
- 干预执行
- 健康跟进

#### 专家模块 (Expert)
- 工作台: `/expert-portal`
- 教练督导
- 晋级审核
- 培训直播

#### 管理员模块 (Admin)
- 仪表盘: `/dashboard`
- 平台配置
- 用户管理
- 数据统计

**访问方式**:
```
主实例: http://localhost:5174
备用实例: http://localhost:5177
```

---

### H5 患者应用 (:5175, :5176)

**技术栈**: Vue 3 + Vant + Pinia
**定位**: 患者专用移动端应用
**主要功能**:
- 登录/注册
- 健康数据录入
- 评估结果查看
- 个人健康档案
- 测评历史记录

**访问方式**:
```
主实例: http://localhost:5175
备用实例: http://localhost:5176
```

**演示页面**:
```
file:///D:/behavioral-health-project/h5-patient-app/快速预览演示.html
```

---

## 🔌 后端 API 详细说明

### Agent Gateway (:8000)

**框架**: FastAPI + Python
**功能**: 智能代理网关，统一API入口
**主要端点**:
- `/docs` - Swagger 文档
- `/health` - 健康检查
- `/api/assessment/submit` - 提交评估
- `/api/intervention/*` - 干预相关

**访问方式**:
```
API文档: http://localhost:8000/docs
健康检查: http://localhost:8000/health
```

---

### BAPS 评估 API (:8001)

**框架**: FastAPI + Python
**功能**: 行为评估与个性化系统
**主要能力**:
- 健康风险评估
- 行为模式分析
- Trigger识别
- 风险分级 (R0-R4)
- Agent路由决策

**访问方式**:
```
API文档: http://localhost:8001/docs
健康检查: http://localhost:8001/health
```

---

### 决策引擎 + 教练 (:8002)

**框架**: FastAPI + Python + Dify集成
**功能**: AI决策 + 健康教练聊天
**主要端点**:
- `/intervene` - 决策干预 (POST)
- `/chat` - 流式对话 (POST, SSE)
- `/chat_sync` - 同步对话 (POST)
- `/latest_status` - 最新状态 (GET)

**特性**:
- SSE (Server-Sent Events) 流式响应
- Dify Workflow 集成
- Ollama 本地LLM支持
- 实时决策建议

**访问方式**:
```
API文档: http://localhost:8002/docs
健康检查: http://localhost:8002/health
```

---

## 🏗️ 基础设施服务

### Dify AI 平台 (:8080)

**类型**: Docker 容器组 (9个容器)
**功能**: LLM应用开发平台
**容器列表**:
- dify-api-1
- dify-worker-1
- dify-web-1
- dify-db-1 (PostgreSQL)
- dify-redis-1 (Redis)
- dify-weaviate-1 (向量数据库)
- dify-nginx-1
- dify-sandbox-1
- dify-ssrf_proxy-1

**主要功能**:
- AI工作流编排
- 知识库管理
- 对话应用创建
- 多模型集成

**访问方式**:
```
控制台: http://localhost:8080
账号: 联系管理员获取
```

---

### Ollama (:11434)

**类型**: 本地LLM推理服务
**功能**: 离线大语言模型
**支持模型**:
- qwen2.5:7b (默认)
- llama系列
- 其他开源模型

**主要端点**:
- `/api/tags` - 查看已安装模型
- `/api/generate` - 文本生成
- `/api/chat` - 对话生成

**访问方式**:
```
查看模型: http://localhost:11434/api/tags
API地址: http://localhost:11434
```

---

## 📄 静态演示页面

### 主动健康指挥舱 (index.html)

**位置**: `D:\behavioral-health-project\index.html`
**技术**: HTML + Bootstrap 5 + Chart.js
**功能**:
- 血糖波动趋势图
- AI实时决策建议
- 健康教练聊天 (SSE流式)
- 数据输入面板
- 绿色主题设计

**访问方式**:
```
file:///D:/behavioral-health-project/index.html
```

**后端依赖**: 需要8002端口API支持

---

### 患者实时看板 (patient_portal.html)

**位置**: `D:\behavioral-health-project\patient_portal.html`
**技术**: HTML + Bootstrap 5 + Chart.js
**功能**:
- 实时血糖趋势 (CGM)
- AI决策建议
- 健康教练对话
- 手动数据同步
- 自动5秒刷新

**访问方式**:
```
file:///D:/behavioral-health-project/patient_portal.html
```

**后端依赖**: 需要8002端口API支持

---

### H5应用快速预览 (快速预览演示.html)

**位置**: `D:\behavioral-health-project\h5-patient-app\快速预览演示.html`
**技术**: 纯HTML + CSS
**功能**:
- 登录页面预览
- 首页界面预览
- 数据输入页预览
- 结果展示页预览
- 手机界面模拟

**访问方式**:
```
file:///D:/behavioral-health-project/h5-patient-app/快速预览演示.html
```

---

## 🔐 测试账号完整列表

| 角色 | 用户名 | 密码 | 权限级别 | 姓名 | 登录后跳转 |
|------|--------|------|----------|------|------------|
| 患者 | `patient` | `123456` | Level 0 | 小明 | `/client` (绿色界面) |
| 教练 | `coach` | `123456` | Level 2 | 李教练 | `/coach-portal` |
| 专家 | `expert` | `123456` | Level 3 | 张专家 | `/expert-portal` |
| 管理员 | `admin` | `admin123` | Level 4 | 管理员 | `/dashboard` |

**登录入口**:
```
http://localhost:5174/#/login
```

---

## 📊 功能对比矩阵

| 功能 | H5移动端<br>5173 | Admin Portal<br>5174 | H5患者应用<br>5175 | 静态页面<br>index.html |
|------|:----------------:|:-------------------:|:-----------------:|:---------------------:|
| 四角色登录 | ❌ | ✅ | ❌ | ❌ |
| 患者绿色主页 | ⚠️ 部分 | ✅ **完整** | ✅ | ⚠️ 简化版 |
| 每日任务 | ✅ | ✅ | ⚠️ | ❌ |
| 用药提醒 | ✅ | ✅ **完整** | ⚠️ | ⚠️ |
| 学习推荐 | ⚠️ | ✅ 视频+课程 | ❌ | ❌ |
| 教练工作台 | ❌ | ✅ | ❌ | ❌ |
| 专家工作台 | ❌ | ✅ | ❌ | ❌ |
| 实时图表 | ✅ Echarts | ⚠️ | ⚠️ | ✅ Chart.js |
| AI聊天 | ⚠️ | ✅ | ⚠️ | ✅ SSE流式 |

**图例**:
- ✅ = 完整支持，功能齐全
- ⚠️ = 部分支持，功能简化
- ❌ = 不支持

---

## 🚀 推荐使用方案

### 方案 A: 完整体验 (推荐)

1. **访问四角色登录页面**
   ```
   http://localhost:5174/#/login
   ```

2. **使用患者账号登录**
   ```
   用户名: patient
   密码: 123456
   ```

3. **自动跳转到绿色用户界面**
   ```
   http://localhost:5174/#/client
   ```
   可以体验：
   - ✅ 每日任务打卡
   - ✅ 用药提醒 (点击用药卡片)
   - ✅ 推荐视频和课程
   - ✅ 教练行为推荐
   - ✅ AI健康助手

4. **查看API文档**
   ```
   http://localhost:8002/docs
   ```

---

### 方案 B: 静态页面演示

1. **打开实时指挥舱**
   ```
   file:///D:/behavioral-health-project/index.html
   ```
   - 需要确保 8002 端口API运行中
   - 可输入血糖值测试AI决策
   - 可与健康教练对话

2. **打开患者实时看板**
   ```
   file:///D:/behavioral-health-project/patient_portal.html
   ```
   - 自动每5秒刷新数据
   - 实时血糖趋势图
   - AI教练聊天功能

---

### 方案 C: 移动端体验

1. **H5患者应用**
   ```
   http://localhost:5175
   ```
   - 移动端UI设计
   - Vant组件库
   - 适配手机屏幕

2. **H5移动端**
   ```
   http://localhost:5173
   ```
   - Echarts图表
   - 移动交互优化

---

## 🛠️ 服务管理

### 启动所有服务
```bash
cd D:\behavioral-health-project
start_all.bat
```

### 停止所有服务
在 start_all.bat 窗口中按任意键

### 单独启动前端
```bash
# H5 移动端
cd D:\behavioral-health-project\h5
npm run dev

# Admin Portal
cd D:\behavioral-health-project\admin-portal
npm run dev

# H5 患者应用
cd D:\behavioral-health-project\h5-patient-app
npm run dev
```

### 单独启动后端
```bash
# Agent Gateway (8000)
cd D:\behavioral-health-project
python -m uvicorn api.main:app --host 0.0.0.0 --port 8000

# BAPS API (8001)
python -m uvicorn api.baps_api:app --host 0.0.0.0 --port 8001

# Decision Engine (8002)
python -m uvicorn main:app --host 0.0.0.0 --port 8002
```

---

## 📋 日志位置

所有服务日志存储在:
```
D:\behavioral-health-project\logs\
```

日志文件:
- `gateway_8000.log` - Agent Gateway
- `baps_8001.log` - BAPS API
- `decision_8002.log` - Decision Engine
- `h5_5173.log` - H5 移动端
- `admin_5174.log` - Admin Portal
- `patient_5175.log` - H5 患者应用

---

## 💡 常见问题

### Q1: 找不到四角色登录页面？
**A**: 访问 http://localhost:5174/#/login

### Q2: 找不到绿色用户界面？
**A**:
- 方式1: 访问 http://localhost:5174/#/client
- 方式2: 登录页面用 patient/123456 登录后自动跳转

### Q3: 5174 和 5177 有什么区别？
**A**: 没有区别，都是 admin-portal 应用的不同实例，功能完全相同。

### Q4: 静态页面无法连接后端？
**A**: 确认 8002 端口服务是否运行:
```bash
curl http://localhost:8002/health
```

### Q5: 如何访问Dify平台？
**A**: http://localhost:8080，账号需联系管理员获取

---

## 📞 技术支持

- **项目文档**: `D:\behavioral-health-project\docs\`
- **API文档**: http://localhost:8002/docs
- **快速开始**: `D:\behavioral-health-project\QUICKSTART.md`
- **项目总览**: `D:\behavioral-health-project\PROJECT_SUMMARY.md`

---

**最后更新**: 2026-02-03
**文档维护**: 行为健康平台开发团队
